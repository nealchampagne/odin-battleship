(()=>{"use strict";var __webpack_modules__={877:(__unused_webpack___webpack_module__,__unused_webpack___webpack_exports__,__webpack_require__)=>{eval('\n;// ./src/ship.js\nconst Ship = (name) => {\n  // Determine ship size based on the provided ship name\n  const getSize = (name) => {\n    if (name === "carrier") return 5;\n    if (name === "battleship") return 4;\n    if (name === "cruiser") return 3;\n    if (name === "submarine") return 3;\n    if (name === "destroyer") return 2;\n  };\n\n  const size = getSize(name);\n\n  // Counter for number of hits the ship has taken\n  let hitCount = 0;\n\n  // Increment the ship\'s hit count on hit\n  const hit = () => {\n    hitCount++;\n  };\n\n  // Check if the ship is sunk based on number of hits taken\n  const isSunk = () => {\n    return hitCount === size ? [name, size] : false;\n  };\n\n  return { name, size, hit, isSunk };\n};\n\n;// ./src/gameboard.js\n\n\nconst Gameboard = () => {\n  const boardObjects = [];\n\n  // Set size of board grid\n  const gridSize = 9;\n\n  // Function to make sure a given range on the board is empty\n  const checkEmpty = (range, direction, x, y) => {\n    let isEmpty = true;\n\n    for (let i = 0; i < range; i++) {\n      boardObjects.forEach((obj) => {\n        obj.positionArray.forEach((element) => {\n          if (direction === "horizontal") {\n            if (JSON.stringify(element) === `[${x + i},${y}]`) {\n              isEmpty = false;\n            }\n          } else if (direction === "vertical") {\n            if (JSON.stringify(element) === `[${x},${y + i}]`) {\n              isEmpty = false;\n            }\n          }\n        });\n      });\n    }\n    return isEmpty;\n  };\n\n  // Place ships on the board\n  const placeShip = (name, direction, x, y) => {\n    // Create an array to hold all the squares the ship occupies\n    const positionArray = [];\n\n    // Create a ship of the given type\n    const ship = Ship(name);\n\n    // Throw an error if the space is occupied or if the ship goes off the board\n    if (!checkEmpty(ship.size, direction, x, y)) {\n      throw new Error("Cannot place ship in an occupied space");\n    } else {\n      if (direction === "horizontal") {\n        if (x + (ship.size - 1) > gridSize) {\n          throw new Error("Cannot place ship off the board");\n        } else {\n          for (let i = 0; i < ship.size; i++) {\n            positionArray.push([x + i, y]);\n          }\n        }\n      } else if (direction === "vertical") {\n        if (y + (ship.size - 1) > gridSize) {\n          throw new Error("Cannot place ship off the board");\n        } else {\n          for (let i = 0; i < ship.size; i++) {\n            positionArray.push([x, y + i]);\n          }\n        }\n      }\n\n      // Otherwise, add the new object to the board objects array\n      boardObjects.push({ positionArray, ship });\n\n      // Return the object containing the position array and the new ship\n      return { positionArray, ship };\n    }\n  };\n\n  // Handle logic when a board square is attacked\n  const receiveAttack = (visitedArray, x, y) => {\n    // Throw error if the square has already been visited\n    if (\n      visitedArray.some((element) => JSON.stringify(element) === `[${x},${y}]`)\n    ) {\n      throw new Error("Please choose an unvisited square");\n    }\n\n    // Otherwise if it\'s a hit, invoke hit method of ship and return true\n    let isHit = false;\n    boardObjects.forEach((obj) => {\n      if (\n        obj.positionArray.find(\n          (element) => JSON.stringify(element) === `[${x},${y}]`,\n        )\n      ) {\n        obj.ship.hit();\n        isHit = true;\n      }\n    });\n\n    // Add the square to the visited array\n    visitedArray.push([x, y]);\n\n    return isHit;\n  };\n\n  // Check if all the ships on the board are sunk\n  const checkAllSunk = () => {\n    let allSunk = true;\n    boardObjects.forEach((obj) => {\n      if (obj.ship.isSunk() === false) {\n        allSunk = false;\n      }\n    });\n    return allSunk;\n  };\n\n  return {\n    gridSize,\n    placeShip,\n    checkEmpty,\n    boardObjects,\n    receiveAttack,\n    checkAllSunk,\n  };\n};\n\n;// ./src/player.js\n\n\nconst Player = (name, array = []) => {\n  // Each player needs their own Gameboard object\n  const board = Gameboard();\n\n  // Invoke receiveAttack on the provided board\n  const attack = (playerBoard, x, y, visitedArray = array) => {\n    return playerBoard.receiveAttack(visitedArray, x, y);\n  };\n\n  // Some general housekeeping variables\n  let hunterMode = false;\n  let linearHunt = false;\n  let sunkLength = 0;\n\n  const hitArray = [];\n  let targetArray = [];\n\n  // Define parameters to filter out invalid shots\n  const filterParams = (arr, visitedArray) =>\n    arr[0] >= 0 &&\n    arr[0] <= board.gridSize &&\n    arr[1] >= 0 &&\n    arr[1] <= board.gridSize &&\n    !JSON.stringify(visitedArray).includes(`${JSON.stringify(arr)}`);\n\n  const getHunterMode = () => hunterMode;\n\n  // Generate random values for computerAttack **UPGRADE THIS LATER**\n  const getRandomValue = () => Math.floor(Math.random() * (board.gridSize + 1));\n\n  const computerAttack = (\n    playerBoard,\n    x = getRandomValue(),\n    y = getRandomValue(),\n    visitedArray = array,\n  ) => {\n    let isHit = false;\n\n    // During random search\n    if (hunterMode === false) {\n      // If the random space has been visited, reroll until a new space is found\n      while (\n        visitedArray.some(\n          (element) => JSON.stringify(element) === `[${x},${y}]`,\n        )\n      ) {\n        x = getRandomValue();\n        y = getRandomValue();\n      }\n\n      if (playerBoard.receiveAttack(visitedArray, x, y)) {\n        isHit = true;\n\n        playerBoard.boardObjects.forEach((obj) => {\n          if (\n            obj.positionArray.some(\n              (element) => JSON.stringify(element) === `[${x},${y}]`,\n            )\n          ) {\n            /** If the hit sinks the ship, do not activate hunter mode,\n             *  otherwise begin hunting logic */\n            if (obj.ship.isSunk()) {\n              console.log("Sunk em!");\n              hunterMode = false;\n            } else {\n              hunterMode = true;\n              linearHunt = true;\n\n              hitArray.push([x, y]);\n\n              const adjacencyArray = [\n                [x - 1, y],\n                [x + 1, y],\n                [x, y - 1],\n                [x, y + 1],\n              ].filter((arr) => {\n                return filterParams(arr, visitedArray);\n              });\n\n              adjacencyArray.forEach((element) => {\n                targetArray.push(element);\n              });\n              targetArray.sort();\n            }\n          }\n        });\n      }\n\n      /** Pass values back to for the DOM manipulating code to process */\n      return [isHit, x, y];\n    } else if (hunterMode === true) {\n      targetArray.sort();\n\n      if (targetArray.length === 0) {\n        linearHunt = false;\n\n        hitArray.forEach((arr) => {\n          const newTargets = [\n            [arr[0] - 1, arr[1]],\n            [arr[0] + 1, arr[1]],\n            [arr[0], arr[1] - 1],\n            [arr[0], arr[1] + 1],\n          ];\n          newTargets.forEach((arr) => targetArray.push(arr));\n        });\n      }\n\n      // Filter out any invalid targets in the array\n      targetArray = targetArray.filter((arr) => {\n        return filterParams(arr, visitedArray);\n      });\n\n      // Pick a target at random from the valid targets\n      let target = targetArray[Math.floor(Math.random() * targetArray.length)];\n\n      // Handle logic if the attack is a hit\n      if (playerBoard.receiveAttack(visitedArray, target[0], target[1])) {\n        isHit = true;\n\n        hitArray.push(target);\n\n        playerBoard.boardObjects.forEach((obj) => {\n          if (\n            obj.positionArray.some(\n              (element) =>\n                JSON.stringify(element) === `[${target[0]},${target[1]}]`,\n            )\n          ) {\n            // If the hit sinks the ship,deactivate hunter mode,\n            if (obj.ship.isSunk()) {\n              sunkLength += obj.ship.size;\n\n              if (sunkLength === hitArray.length) {\n                hunterMode = false;\n                linearHunt = false;\n                sunkLength = 0;\n                hitArray.length = 0;\n                targetArray.length = 0;\n              }\n            }\n          }\n        });\n\n        // If the hit doesn\'t turn off hunter mode, continue hunting logic\n        if (hunterMode === true) {\n          hitArray.sort();\n\n          if (linearHunt === true) {\n            targetArray.length = 0;\n            if (hitArray[0][0] === hitArray[1][0]) {\n              targetArray.push(\n                [hitArray[0][0], hitArray[0][1] - 1],\n                [hitArray[0][0], hitArray[hitArray.length - 1][1] + 1],\n              );\n            } else if (hitArray[0][1] === hitArray[0][1]) {\n              targetArray.push(\n                [hitArray[0][0] - 1, hitArray[0][1]],\n                [hitArray[hitArray.length - 1][0] + 1, hitArray[0][1]],\n              );\n            }\n          }\n\n          // Filter out any invalid targets\n          targetArray = targetArray.filter((arr) => {\n            return filterParams(arr, visitedArray);\n          });\n        }\n      } else {\n        // On a miss, remove that item from the target array\n        targetArray.splice(targetArray.indexOf(target), 1);\n      }\n\n      // Return whether it was a hit or not and location for styling purposes\n      return [isHit, target[0], target[1]];\n    }\n  };\n\n  return {\n    name,\n    get visitedArray() {\n      return array;\n    },\n    board,\n    attack,\n    hitArray,\n    targetArray,\n    computerAttack,\n    getHunterMode,\n  };\n};\n\n;// ./src/clearchildren.js\n// Simple helper module for clearing DOM children\nconst clearChildren = (node) => {\n  while (node.firstChild) {\n    node.removeChild(node.lastChild);\n  }\n};\n\n;// ./src/images/waves.jpg\nconst waves_namespaceObject = __webpack_require__.p + "e85960e2858fa22f448b.jpg";\n;// ./src/images/fiveship.png\nconst fiveship_namespaceObject = __webpack_require__.p + "e0a36e417f04c9b2cca0.png";\n;// ./src/images/fourship.png\nconst fourship_namespaceObject = __webpack_require__.p + "bcc7240150cebf498514.png";\n;// ./src/images/threeship.png\nconst threeship_namespaceObject = __webpack_require__.p + "c4eb544ac204affcc24c.png";\n;// ./src/images/twoship.png\nconst twoship_namespaceObject = __webpack_require__.p + "5f14861ce9434a7fd260.png";\n;// ./src/index.js\n\n\n\n\n\n\n\n\n\n\nconst homeLoad = () => {\n  /** Grab/create DOM elements */\n  const body = document.body;\n\n  const modalContainer = document.createElement("div");\n  const modeModal = document.createElement("div");\n  const modeMessage = document.createElement("div");\n  const modeButtonContainer = document.createElement("div");\n  const onePlayerButton = document.createElement("button");\n  const twoPlayerButton = document.createElement("button");\n\n  const header = document.createElement("div");\n  const headContainer = document.createElement("div");\n  const title = document.createElement("div");\n\n  const content = document.getElementById("content");\n  const main = document.createElement("div");\n\n  const nameContainer = document.createElement("div");\n  const leftName = document.createElement("div");\n  const rightName = document.createElement("div");\n\n  const boardContainer = document.createElement("div");\n  const leftShipTray = document.createElement("div");\n  const leftCarrierLabel = document.createElement("div");\n  const leftBattleshipLabel = document.createElement("div");\n  const leftCruiserLabel = document.createElement("div");\n  const leftSubmarineLabel = document.createElement("div");\n  const leftDestroyerLabel = document.createElement("div");\n  const leftBoard = document.createElement("div");\n  const rightBoard = document.createElement("div");\n  const rightShipTray = document.createElement("div");\n  const rightCarrierLabel = document.createElement("div");\n  const rightBattleshipLabel = document.createElement("div");\n  const rightCruiserLabel = document.createElement("div");\n  const rightSubmarineLabel = document.createElement("div");\n  const rightDestroyerLabel = document.createElement("div");\n\n  const helpText = document.createElement("div");\n\n  const interstitialModal = document.createElement("div");\n  const interstitialText = document.createElement("div");\n  const readyButton = document.createElement("button");\n\n  const errorModal = document.createElement("div");\n  const errorText = document.createElement("div");\n  const errorButton = document.createElement("button");\n\n  const endModal = document.createElement("div");\n  const endText = document.createElement("div");\n  const resetButton = document.createElement("button");\n\n  const footContainer = document.createElement("div");\n  const footer = document.createElement("div");\n\n  const wavesImage = new Image();\n  const leftCarrierImage = new Image();\n  const leftBattleshipImage = new Image();\n  const leftCruiserImage = new Image();\n  const leftSubmarineImage = new Image();\n  const leftDestroyerImage = new Image();\n  const rightCarrierImage = new Image();\n  const rightBattleshipImage = new Image();\n  const rightCruiserImage = new Image();\n  const rightSubmarineImage = new Image();\n  const rightDestroyerImage = new Image();\n\n  /** Assign image sources */\n  wavesImage.src = waves_namespaceObject;\n  leftCarrierImage.src = fiveship_namespaceObject;\n  leftBattleshipImage.src = fourship_namespaceObject;\n  leftCruiserImage.src = threeship_namespaceObject;\n  leftSubmarineImage.src = threeship_namespaceObject;\n  leftDestroyerImage.src = twoship_namespaceObject;\n  rightCarrierImage.src = fiveship_namespaceObject;\n  rightBattleshipImage.src = fourship_namespaceObject;\n  rightCruiserImage.src = threeship_namespaceObject;\n  rightSubmarineImage.src = threeship_namespaceObject;\n  rightDestroyerImage.src = twoship_namespaceObject;\n\n  /** Add CSS selectors */\n  modalContainer.classList.add("modalcontainer");\n  modeModal.classList.add("modal");\n  modeMessage.classList.add("modemessage");\n  modeButtonContainer.classList.add("modebtncontainer");\n\n  header.classList.add("header");\n  headContainer.classList.add("headcontainer");\n  title.classList.add("title");\n\n  main.classList.add("main");\n  nameContainer.classList.add("namecontainer");\n  leftName.classList.add("name");\n  rightName.classList.add("name");\n\n  boardContainer.classList.add("boardcontainer");\n  leftBoard.classList.add("board");\n  rightBoard.classList.add("board");\n\n  leftShipTray.classList.add("shiptray");\n  leftCarrierImage.classList.add("shipimage");\n  leftBattleshipImage.classList.add("shipimage");\n  leftCruiserImage.classList.add("shipimage");\n  leftSubmarineImage.classList.add("shipimage");\n  leftDestroyerImage.classList.add("shipimage");\n  leftCarrierLabel.classList.add("shiplabel");\n  leftBattleshipLabel.classList.add("shiplabel");\n  leftCruiserLabel.classList.add("shiplabel");\n  leftSubmarineLabel.classList.add("shiplabel");\n  leftDestroyerLabel.classList.add("shiplabel");\n\n  rightShipTray.classList.add("shiptray");\n  rightCarrierImage.classList.add("shipimage");\n  rightBattleshipImage.classList.add("shipimage");\n  rightCruiserImage.classList.add("shipimage");\n  rightSubmarineImage.classList.add("shipimage");\n  rightDestroyerImage.classList.add("shipimage");\n  rightCarrierLabel.classList.add("shiplabel");\n  rightBattleshipLabel.classList.add("shiplabel");\n  rightCruiserLabel.classList.add("shiplabel");\n  rightSubmarineLabel.classList.add("shiplabel");\n  rightDestroyerLabel.classList.add("shiplabel");\n\n  helpText.classList.add("helptext");\n\n  interstitialModal.classList.add("modal");\n  interstitialText.classList.add("intertext");\n\n  errorModal.classList.add("modal", "error");\n  errorText.classList.add("errortext");\n  errorButton.classList.add("errorbtn");\n\n  endModal.classList.add("modal");\n  endText.classList.add("endtext");\n\n  footContainer.classList.add("footcontainer");\n  footer.classList.add("footer");\n\n  /** Populate text content */\n  title.textContent = "Battleship";\n  leftCarrierLabel.textContent = "Carrier";\n  leftBattleshipLabel.textContent = "Battleship";\n  leftCruiserLabel.textContent = "Cruiser";\n  leftSubmarineLabel.textContent = "Submarine";\n  leftDestroyerLabel.textContent = "Destroyer";\n  rightCarrierLabel.textContent = "Carrier";\n  rightBattleshipLabel.textContent = "Battleship";\n  rightCruiserLabel.textContent = "Cruiser";\n  rightSubmarineLabel.textContent = "Submarine";\n  rightDestroyerLabel.textContent = "Destroyer";\n\n  modeMessage.textContent = "Select game mode:";\n  onePlayerButton.textContent = "One Player";\n  twoPlayerButton.textContent = "Two Player";\n\n  readyButton.textContent = "Ready";\n\n  footer.textContent = "By Neal Champagne: October 2024";\n\n  interstitialModal.style.display = "none";\n  readyButton.addEventListener("click", () => closeInterstitial(playerTurn));\n\n  errorModal.style.display = "none";\n  errorButton.textContent = "Close";\n  errorButton.addEventListener("click", () => {\n    errorModal.style.display = "none";\n  });\n\n  endModal.style.display = "none";\n  resetButton.textContent = "New Game";\n  resetButton.addEventListener("click", () => homeLoad());\n  /** Set background images for boards and main body */\n  leftBoard.style.backgroundImage = `url(${waves_namespaceObject})`;\n  leftBoard.style.backgroundSize = "cover";\n  rightBoard.style.backgroundImage = `url(${waves_namespaceObject})`;\n  rightBoard.style.backgroundSize = "cover";\n  body.style.backgroundImage = `url(${waves_namespaceObject})`;\n  body.style.backgroundSize = "cover";\n\n  /** Wipe the slate clean for resets */\n  clearChildren(content);\n\n  main.appendChild(modalContainer);\n  modalContainer.appendChild(modeModal);\n  modeModal.appendChild(modeMessage);\n  modeModal.appendChild(modeButtonContainer);\n  modeButtonContainer.appendChild(onePlayerButton);\n  modeButtonContainer.appendChild(twoPlayerButton);\n\n  content.appendChild(header);\n  header.appendChild(headContainer);\n  headContainer.appendChild(title);\n\n  content.appendChild(main);\n  main.appendChild(nameContainer);\n  nameContainer.appendChild(leftName);\n  nameContainer.appendChild(rightName);\n\n  main.appendChild(boardContainer);\n  boardContainer.appendChild(leftShipTray);\n  leftShipTray.appendChild(leftCarrierLabel);\n  leftShipTray.appendChild(leftCarrierImage);\n  leftShipTray.appendChild(leftBattleshipLabel);\n  leftShipTray.appendChild(leftBattleshipImage);\n  leftShipTray.appendChild(leftCruiserLabel);\n  leftShipTray.appendChild(leftCruiserImage);\n  leftShipTray.appendChild(leftSubmarineLabel);\n  leftShipTray.appendChild(leftSubmarineImage);\n  leftShipTray.appendChild(leftDestroyerLabel);\n  leftShipTray.appendChild(leftDestroyerImage);\n\n  boardContainer.appendChild(leftBoard);\n  boardContainer.appendChild(rightBoard);\n\n  boardContainer.appendChild(rightShipTray);\n  rightShipTray.appendChild(rightCarrierLabel);\n  rightShipTray.appendChild(rightCarrierImage);\n  rightShipTray.appendChild(rightBattleshipLabel);\n  rightShipTray.appendChild(rightBattleshipImage);\n  rightShipTray.appendChild(rightCruiserLabel);\n  rightShipTray.appendChild(rightCruiserImage);\n  rightShipTray.appendChild(rightSubmarineLabel);\n  rightShipTray.appendChild(rightSubmarineImage);\n  rightShipTray.appendChild(rightDestroyerLabel);\n  rightShipTray.appendChild(rightDestroyerImage);\n\n  main.appendChild(helpText);\n\n  modalContainer.appendChild(interstitialModal);\n  interstitialModal.appendChild(interstitialText);\n  interstitialModal.appendChild(readyButton);\n\n  modalContainer.appendChild(errorModal);\n  errorModal.appendChild(errorText);\n  errorModal.appendChild(errorButton);\n\n  modalContainer.appendChild(endModal);\n  endModal.appendChild(endText);\n  endModal.appendChild(resetButton);\n\n  content.appendChild(footContainer);\n  footContainer.appendChild(footer);\n\n  /** Initialize necessary variables and arrays */\n  let pvpMode = false;\n  let setupPhase = false;\n  let battlePhase = false;\n\n  let player1;\n  let player2;\n\n  let placeCarrier = false;\n  let placeBattleship = false;\n  let placeCruiser = false;\n  let placeSubmarine = false;\n  let placeDestroyer = false;\n\n  let placeDirection = "horizontal";\n  let hoverTarget;\n\n  const playerOneSquares = [];\n  const playerTwoSquares = [];\n  const visitedArray1 = [];\n  const visitedArray2 = [];\n\n  let playerTurn = "player1";\n\n  /** Close mode-select modal and begin setup */\n  const closeModeModal = () => {\n    if (pvpMode) {\n      leftName.textContent = "Player 1";\n      rightName.textContent = "Player 2";\n      helpText.textContent = `Take turns placing ships by clicking on the desired square.\n      Press spacebar to rotate ship. Don\'t let the other player watch while you position your fleet!`;\n      rightBoard.style.pointerEvents = "none";\n    } else if (!pvpMode) {\n      helpText.textContent = `Place your ships by clicking on the desired square.\n      Press spacebar to rotate ship.`;\n    }\n    leftBoard.style.pointerEvents = "auto";\n    modeModal.style.display = "none";\n    setupPhase = true;\n    placeCarrier = true;\n  };\n\n  /** Procede to 1-player game and close modal */\n  onePlayerButton.addEventListener("click", () => {\n    pvpMode = false;\n    closeModeModal();\n  });\n\n  /** Activate PvP and close modal */\n  twoPlayerButton.addEventListener("click", () => {\n    pvpMode = true;\n    closeModeModal();\n  });\n\n  /** Listen for spacebar to rotate ship placement */\n  document.addEventListener("keydown", (event) => {\n    if (setupPhase && event.code === "Space") {\n      placeDirection =\n        placeDirection === "horizontal" ? "vertical" : "horizontal";\n      event.preventDefault();\n    }\n  });\n\n  /** Add \'hit\' class on hit */\n  const hitSquare = (square) => {\n    square.textContent = "X";\n    square.classList.add("hit");\n  };\n\n  /** Add \'miss\' class on miss */\n  const missSquare = (square) => {\n    square.textContent = "O";\n    square.classList.add("miss");\n  };\n\n  /** Check for sunk ships after attacking, update CSS as necessary */\n  const markSunkShips = (player, board) => {\n    player.board.boardObjects.forEach((obj) => {\n      if (obj.ship.isSunk()[0] === "carrier") {\n        if (board === leftBoard) {\n          leftCarrierImage.classList.add("sunkship");\n          leftCarrierLabel.classList.add("sunklabel");\n        } else {\n          rightCarrierImage.classList.add("sunkship");\n          rightCarrierLabel.classList.add("sunklabel");\n        }\n      } else if (obj.ship.isSunk()[0] === "battleship") {\n        if (board === leftBoard) {\n          leftBattleshipImage.classList.add("sunkship");\n          leftBattleshipLabel.classList.add("sunklabel");\n        } else {\n          rightBattleshipImage.classList.add("sunkship");\n          rightBattleshipLabel.classList.add("sunklabel");\n        }\n      } else if (obj.ship.isSunk()[0] === "cruiser") {\n        if (board === leftBoard) {\n          leftCruiserImage.classList.add("sunkship");\n          leftCruiserLabel.classList.add("sunklabel");\n        } else {\n          rightCruiserImage.classList.add("sunkship");\n          rightCruiserLabel.classList.add("sunklabel");\n        }\n      } else if (obj.ship.isSunk()[0] === "submarine") {\n        if (board === leftBoard) {\n          leftSubmarineImage.classList.add("sunkship");\n          leftSubmarineLabel.classList.add("sunklabel");\n        } else {\n          rightSubmarineImage.classList.add("sunkship");\n          rightSubmarineLabel.classList.add("sunklabel");\n        }\n      } else if (obj.ship.isSunk()[0] === "destroyer") {\n        if (board === leftBoard) {\n          leftDestroyerImage.classList.add("sunkship");\n          leftDestroyerLabel.classList.add("sunklabel");\n        } else {\n          rightDestroyerImage.classList.add("sunkship");\n          rightDestroyerLabel.classList.add("sunklabel");\n        }\n      }\n    });\n  };\n\n  /** Generate board squares and attach necessary CSS selectors */\n  const fillBoard = (player, board, enemy) => {\n    for (let i = 0; i < Gameboard().gridSize + 1; i++) {\n      for (let j = 0; j < Gameboard().gridSize + 1; j++) {\n        const square = document.createElement("div");\n\n        square.setAttribute("id", `${player.name}${j}${i}`);\n        square.classList.add(`${player.name}`, "square");\n\n        if (!pvpMode) {\n          if (player.name === "player2") {\n            square.classList.add("fogofwar");\n          }\n        }\n\n        square.addEventListener("mouseover", () => {\n          hoverTarget = square;\n          let size;\n          if (setupPhase) {\n            if (placeCarrier) {\n              size = 5;\n            } else if (placeBattleship) {\n              size = 4;\n            } else if (placeCruiser || placeSubmarine) {\n              size = 3;\n            } else if (placeDestroyer) {\n              size = 2;\n            }\n            highlightRange(player, size, placeDirection, j, i);\n          }\n        });\n\n        document.addEventListener("keydown", (event) => {\n          if (setupPhase && event.code === "Space") {\n            if (hoverTarget === square) {\n              let size;\n              if (placeCarrier) {\n                size = 5;\n              } else if (placeBattleship) {\n                size = 4;\n              } else if (placeCruiser || placeSubmarine) {\n                size = 3;\n              } else if (placeDestroyer) {\n                size = 2;\n              }\n              clearHighlight(player);\n              highlightRange(player, size, placeDirection, j, i);\n            }\n          }\n        });\n\n        square.addEventListener("mouseout", () => {\n          if (setupPhase) {\n            clearHighlight(player);\n            hoverTarget = undefined;\n          }\n        });\n\n        square.addEventListener("click", () => {\n          if (setupPhase) {\n            if (placeCarrier) {\n              try {\n                placeOwnShip(player, "carrier", placeDirection, j, i);\n                stepThroughSetup();\n              } catch (error) {\n                handleError(error);\n              }\n            } else if (placeBattleship) {\n              try {\n                placeOwnShip(player, "battleship", placeDirection, j, i);\n                stepThroughSetup();\n              } catch (error) {\n                handleError(error);\n              }\n            } else if (placeCruiser) {\n              try {\n                placeOwnShip(player, "cruiser", placeDirection, j, i);\n                stepThroughSetup();\n              } catch (error) {\n                handleError(error);\n              }\n            } else if (placeSubmarine) {\n              try {\n                placeOwnShip(player, "submarine", placeDirection, j, i);\n                stepThroughSetup();\n              } catch (error) {\n                handleError(error);\n              }\n            } else if (placeDestroyer) {\n              try {\n                placeOwnShip(player, "destroyer", placeDirection, j, i);\n                if (pvpMode && playerTurn === "player1") {\n                  togglePlayerTurn();\n                } else {\n                  endSetup(pvpMode);\n                }\n              } catch (error) {\n                handleError(error);\n              }\n            }\n          } else if (battlePhase) {\n            if (enemy.attack(player.board, j, i)) {\n              hitSquare(square);\n            } else {\n              missSquare(square);\n            }\n\n            square.classList.remove("fogofwar");\n\n            markSunkShips(player, board);\n\n            if (player.board.checkAllSunk()) {\n              endGame(enemy);\n            }\n\n            togglePlayerTurn();\n          }\n        });\n\n        board.appendChild(square);\n        player.name === "player1"\n          ? playerOneSquares.push(square)\n          : playerTwoSquares.push(square);\n      }\n    }\n  };\n\n  /** Handle turn switching */\n  const togglePlayerTurn = () => {\n    if (pvpMode) {\n      if (setupPhase) {\n        concealBoard(playerOneSquares);\n        playerTwoSquares.forEach((square) =>\n          square.classList.remove("fogofwar"),\n        );\n        placeCarrier = true;\n        leftBoard.style.pointerEvents = "none";\n        rightBoard.style.pointerEvents = "auto";\n        playerTurn = "player2";\n      } else if (battlePhase) {\n        if (playerTurn === "player1") {\n          concealBoard(playerOneSquares);\n          playerTurn = "player2";\n          showInterstitial(playerTurn);\n        } else {\n          concealBoard(playerTwoSquares);\n          playerTurn = "player1";\n          showInterstitial(playerTurn);\n        }\n      }\n    } else {\n      const computerResult = player2.computerAttack(player1.board);\n      const square = document.getElementById(\n        `player1${computerResult[1]}${computerResult[2]}`,\n      );\n      if (computerResult[0]) {\n        hitSquare(square);\n      } else {\n        missSquare(square);\n      }\n      markSunkShips(player1, leftBoard);\n      if (player1.board.checkAllSunk()) {\n        endGame(player2);\n      }\n    }\n  };\n\n  /** Create two players */\n  const initializePlayers = () => {\n    player1 = Player("player1", visitedArray1);\n    player2 = Player("player2", visitedArray2);\n\n    leftName.textContent = "Player";\n    rightName.textContent = "Computer";\n  };\n\n  /** Step down through ship size for setup purposes */\n  const stepThroughSetup = () => {\n    if (placeCarrier) {\n      placeCarrier = false;\n      placeBattleship = true;\n    } else if (placeBattleship) {\n      placeBattleship = false;\n      placeCruiser = true;\n    } else if (placeCruiser) {\n      placeCruiser = false;\n      placeSubmarine = true;\n    } else if (placeSubmarine) {\n      placeSubmarine = false;\n      placeDestroyer = true;\n    } else if (placeDestroyer) {\n      placeDestroyer = false;\n    }\n  };\n\n  // Transition out of setup mode\n  const endSetup = (pvpMode) => {\n    if (pvpMode) {\n      playerTurn = "player1";\n      showInterstitial(playerTurn);\n      helpText.textContent = `Take turns firing at the other player\'s \n      board until one player sinks all of the other\'s ships.`;\n    } else {\n      placeCarrier = true;\n      placeComputerShips();\n      helpText.textContent = `Fire at the computer\'s board until one fleet\n      or the other is entirely sunk.`;\n    }\n    leftBoard.style.pointerEvents = "none";\n    setupPhase = false;\n    battlePhase = true;\n  };\n\n  // Randomly place the computer\'s fleet in valid positions\n  const placeComputerShips = () => {\n    let placingShips = true;\n\n    while (placingShips) {\n      placeDirection = Math.random() * 2 >= 1 ? "horizontal" : "vertical";\n      let x = Math.floor(Math.random() * (player2.board.gridSize + 1));\n      let y = Math.floor(Math.random() * (player2.board.gridSize + 1));\n      console.log(placeDirection, x, y);\n\n      if (placeCarrier) {\n        try {\n          placeOwnShip(player2, "carrier", placeDirection, x, y);\n          stepThroughSetup();\n        } catch (error) {\n          // Don\'t do anything on error, just try again;\n        }\n      } else if (placeBattleship) {\n        try {\n          placeOwnShip(player2, "battleship", placeDirection, x, y);\n          stepThroughSetup();\n        } catch (error) {\n          // Don\'t do anything, just try again;\n        }\n      } else if (placeCruiser) {\n        try {\n          placeOwnShip(player2, "cruiser", placeDirection, x, y);\n          stepThroughSetup();\n        } catch (error) {\n          // Don\'t do anything, just try again;\n        }\n      } else if (placeSubmarine) {\n        try {\n          placeOwnShip(player2, "submarine", placeDirection, x, y);\n          stepThroughSetup();\n        } catch (error) {\n          // Don\'t do anything, just try again;\n        }\n      } else if (placeDestroyer) {\n        try {\n          placeOwnShip(player2, "destroyer", placeDirection, x, y);\n          placingShips = false;\n        } catch (error) {\n          // Don\'t do anything, just try again;\n        }\n      }\n    }\n  };\n\n  // Intersitial screen to make 2-player possible on one screen\n  const showInterstitial = (turn) => {\n    concealBoard(playerOneSquares);\n    concealBoard(playerTwoSquares);\n    leftBoard.style.pointerEvents = "none";\n    rightBoard.style.pointerEvents = "none";\n    interstitialModal.style.display = "grid";\n    if (turn === "player1") {\n      interstitialText.textContent = `Player 1, click \'Ready\' to proceed with your turn.`;\n    } else if (turn === "player2") {\n      interstitialText.textContent = `Player 2, click \'Ready\' to proceed with your turn.`;\n    }\n  };\n\n  // Transition back from interstitial to the given player\'s turn\n  const closeInterstitial = (turn) => {\n    if (turn === "player1") {\n      playerOneSquares.forEach((square) => square.classList.remove("fogofwar"));\n      rightBoard.style.pointerEvents = "auto";\n    } else if (turn === "player2") {\n      playerTwoSquares.forEach((square) => square.classList.remove("fogofwar"));\n      leftBoard.style.pointerEvents = "auto";\n    }\n    interstitialModal.style.display = "none";\n  };\n\n  // Hide the unvisited squares of a given board\n  const concealBoard = (arr) => {\n    arr.forEach((square) => {\n      if (\n        !square.classList.contains("hit") &&\n        !square.classList.contains("miss")\n      ) {\n        square.classList.add("fogofwar");\n      }\n    });\n  };\n\n  /** Show a ghost image of a ship to review before placing it */\n  const highlightRange = (player, range, direction, x, y) => {\n    for (let i = 0; i < range; i++) {\n      if (\n        direction === "horizontal"\n          ? x + i <= player.board.gridSize\n          : y + i <= player.board.gridSize\n      ) {\n        const square =\n          direction === "horizontal"\n            ? document.getElementById(`${player.name}${x + i}${y}`)\n            : document.getElementById(`${player.name}${x}${y + i}`);\n        square.classList.add("shippreview");\n      }\n    }\n  };\n\n  /** Clear ghost image when not over an element or changing direction */\n  const clearHighlight = (player) => {\n    for (let i = 0; i <= player.board.gridSize; i++) {\n      for (let j = 0; j <= player.board.gridSize; j++) {\n        const square = document.getElementById(`${player.name}${j}${i}`);\n        square.classList.remove("shippreview");\n      }\n    }\n  };\n\n  /** Places a ship on the board and reflects this in the DOM */\n  const placeOwnShip = (player, name, direction, x, y) => {\n    let myShip = player.board.placeShip(name, direction, x, y);\n    for (let i = 0; i < myShip.ship.size; i++) {\n      const square =\n        direction === "horizontal"\n          ? document.getElementById(`${player.name}${x + i}${y}`)\n          : document.getElementById(`${player.name}${x}${y + i}`);\n      square.classList.add("ownfleet");\n    }\n  };\n\n  /** Declare winner and disable attacking behavior */\n  const endGame = (player) => {\n    let winner;\n    let loser;\n\n    if (player === player1) {\n      winner = leftName.textContent;\n      loser = rightName.textContent;\n    } else {\n      winner = rightName.textContent;\n      loser = leftName.textContent;\n    }\n    main.style.pointerEvents = "none";\n    endModal.style.pointerEvents = "auto";\n    endModal.style.display = "grid";\n    helpText.textContent = "";\n    endText.textContent = `${winner} sunk all of ${loser}\'s\n     ships. ${winner} wins!`;\n  };\n\n  // Display errors in a modal for the user\n  const handleError = (error) => {\n    errorModal.style.display = "grid";\n    errorText.textContent = error;\n  };\n\n  initializePlayers();\n\n  fillBoard(player1, leftBoard, player2);\n  fillBoard(player2, rightBoard, player1);\n};\n\nhomeLoad();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODc3LmpzIiwibWFwcGluZ3MiOiI7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBVztBQUNYOzs7QUMxQmlDOztBQUUxQjtBQUNQOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLG9CQUFvQixXQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxNQUFNLEdBQUcsRUFBRTtBQUMzRDtBQUNBO0FBQ0EsWUFBWTtBQUNaLGdEQUFnRCxFQUFFLEdBQUcsTUFBTTtBQUMzRDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQixJQUFJOztBQUVyQjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDBCQUEwQixlQUFlO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsVUFBVTtBQUNWLDBCQUEwQixlQUFlO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMEJBQTBCLHFCQUFxQjs7QUFFL0M7QUFDQSxlQUFlO0FBQ2Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFFQUFxRSxFQUFFLEdBQUcsRUFBRTtBQUM1RTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxFQUFFLEdBQUcsRUFBRTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ25IMkM7O0FBRXBDO0FBQ1A7QUFDQSxnQkFBZ0IsU0FBUzs7QUFFekI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsb0JBQW9COztBQUVsRTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsRUFBRSxHQUFHLEVBQUU7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxFQUFFLEdBQUcsRUFBRTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELFVBQVUsR0FBRyxVQUFVO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDL0xBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQ0wyQztBQUNOO0FBQ2M7QUFDOUI7QUFDa0I7QUFDTTtBQUNBO0FBQ0U7QUFDSjs7QUFFM0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQixxQkFBSztBQUN4Qix5QkFBeUIsd0JBQVE7QUFDakMsNEJBQTRCLHdCQUFRO0FBQ3BDLHlCQUF5Qix5QkFBUztBQUNsQywyQkFBMkIseUJBQVM7QUFDcEMsMkJBQTJCLHVCQUFPO0FBQ2xDLDBCQUEwQix3QkFBUTtBQUNsQyw2QkFBNkIsd0JBQVE7QUFDckMsMEJBQTBCLHlCQUFTO0FBQ25DLDRCQUE0Qix5QkFBUztBQUNyQyw0QkFBNEIsdUJBQU87O0FBRW5DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMscUJBQUssQ0FBQztBQUNqRDtBQUNBLDRDQUE0QyxxQkFBSyxDQUFDO0FBQ2xEO0FBQ0Esc0NBQXNDLHFCQUFLLENBQUM7QUFDNUM7O0FBRUE7QUFDQSxFQUFFLGFBQWE7O0FBRWY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFD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cGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9zaGlwLmpzP2UyMTgiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcz9iZWI1Iiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanM/MjMxMyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvY2xlYXJjaGlsZHJlbi5qcz8yMmIxIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcz9mZDE1Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBTaGlwID0gKG5hbWUpID0+IHtcbiAgLy8gRGV0ZXJtaW5lIHNoaXAgc2l6ZSBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgc2hpcCBuYW1lXG4gIGNvbnN0IGdldFNpemUgPSAobmFtZSkgPT4ge1xuICAgIGlmIChuYW1lID09PSBcImNhcnJpZXJcIikgcmV0dXJuIDU7XG4gICAgaWYgKG5hbWUgPT09IFwiYmF0dGxlc2hpcFwiKSByZXR1cm4gNDtcbiAgICBpZiAobmFtZSA9PT0gXCJjcnVpc2VyXCIpIHJldHVybiAzO1xuICAgIGlmIChuYW1lID09PSBcInN1Ym1hcmluZVwiKSByZXR1cm4gMztcbiAgICBpZiAobmFtZSA9PT0gXCJkZXN0cm95ZXJcIikgcmV0dXJuIDI7XG4gIH07XG5cbiAgY29uc3Qgc2l6ZSA9IGdldFNpemUobmFtZSk7XG5cbiAgLy8gQ291bnRlciBmb3IgbnVtYmVyIG9mIGhpdHMgdGhlIHNoaXAgaGFzIHRha2VuXG4gIGxldCBoaXRDb3VudCA9IDA7XG5cbiAgLy8gSW5jcmVtZW50IHRoZSBzaGlwJ3MgaGl0IGNvdW50IG9uIGhpdFxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgaGl0Q291bnQrKztcbiAgfTtcblxuICAvLyBDaGVjayBpZiB0aGUgc2hpcCBpcyBzdW5rIGJhc2VkIG9uIG51bWJlciBvZiBoaXRzIHRha2VuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gaGl0Q291bnQgPT09IHNpemUgPyBbbmFtZSwgc2l6ZV0gOiBmYWxzZTtcbiAgfTtcblxuICByZXR1cm4geyBuYW1lLCBzaXplLCBoaXQsIGlzU3VuayB9O1xufTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwLmpzXCI7XG5cbmV4cG9ydCBjb25zdCBHYW1lYm9hcmQgPSAoKSA9PiB7XG4gIGNvbnN0IGJvYXJkT2JqZWN0cyA9IFtdO1xuXG4gIC8vIFNldCBzaXplIG9mIGJvYXJkIGdyaWRcbiAgY29uc3QgZ3JpZFNpemUgPSA5O1xuXG4gIC8vIEZ1bmN0aW9uIHRvIG1ha2Ugc3VyZSBhIGdpdmVuIHJhbmdlIG9uIHRoZSBib2FyZCBpcyBlbXB0eVxuICBjb25zdCBjaGVja0VtcHR5ID0gKHJhbmdlLCBkaXJlY3Rpb24sIHgsIHkpID0+IHtcbiAgICBsZXQgaXNFbXB0eSA9IHRydWU7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlOyBpKyspIHtcbiAgICAgIGJvYXJkT2JqZWN0cy5mb3JFYWNoKChvYmopID0+IHtcbiAgICAgICAgb2JqLnBvc2l0aW9uQXJyYXkuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICAgICAgICBpZiAoSlNPTi5zdHJpbmdpZnkoZWxlbWVudCkgPT09IGBbJHt4ICsgaX0sJHt5fV1gKSB7XG4gICAgICAgICAgICAgIGlzRW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiKSB7XG4gICAgICAgICAgICBpZiAoSlNPTi5zdHJpbmdpZnkoZWxlbWVudCkgPT09IGBbJHt4fSwke3kgKyBpfV1gKSB7XG4gICAgICAgICAgICAgIGlzRW1wdHkgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBpc0VtcHR5O1xuICB9O1xuXG4gIC8vIFBsYWNlIHNoaXBzIG9uIHRoZSBib2FyZFxuICBjb25zdCBwbGFjZVNoaXAgPSAobmFtZSwgZGlyZWN0aW9uLCB4LCB5KSA9PiB7XG4gICAgLy8gQ3JlYXRlIGFuIGFycmF5IHRvIGhvbGQgYWxsIHRoZSBzcXVhcmVzIHRoZSBzaGlwIG9jY3VwaWVzXG4gICAgY29uc3QgcG9zaXRpb25BcnJheSA9IFtdO1xuXG4gICAgLy8gQ3JlYXRlIGEgc2hpcCBvZiB0aGUgZ2l2ZW4gdHlwZVxuICAgIGNvbnN0IHNoaXAgPSBTaGlwKG5hbWUpO1xuXG4gICAgLy8gVGhyb3cgYW4gZXJyb3IgaWYgdGhlIHNwYWNlIGlzIG9jY3VwaWVkIG9yIGlmIHRoZSBzaGlwIGdvZXMgb2ZmIHRoZSBib2FyZFxuICAgIGlmICghY2hlY2tFbXB0eShzaGlwLnNpemUsIGRpcmVjdGlvbiwgeCwgeSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBwbGFjZSBzaGlwIGluIGFuIG9jY3VwaWVkIHNwYWNlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZGlyZWN0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgICBpZiAoeCArIChzaGlwLnNpemUgLSAxKSA+IGdyaWRTaXplKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IHBsYWNlIHNoaXAgb2ZmIHRoZSBib2FyZFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAuc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICBwb3NpdGlvbkFycmF5LnB1c2goW3ggKyBpLCB5XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiKSB7XG4gICAgICAgIGlmICh5ICsgKHNoaXAuc2l6ZSAtIDEpID4gZ3JpZFNpemUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgcGxhY2Ugc2hpcCBvZmYgdGhlIGJvYXJkXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaXplOyBpKyspIHtcbiAgICAgICAgICAgIHBvc2l0aW9uQXJyYXkucHVzaChbeCwgeSArIGldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gT3RoZXJ3aXNlLCBhZGQgdGhlIG5ldyBvYmplY3QgdG8gdGhlIGJvYXJkIG9iamVjdHMgYXJyYXlcbiAgICAgIGJvYXJkT2JqZWN0cy5wdXNoKHsgcG9zaXRpb25BcnJheSwgc2hpcCB9KTtcblxuICAgICAgLy8gUmV0dXJuIHRoZSBvYmplY3QgY29udGFpbmluZyB0aGUgcG9zaXRpb24gYXJyYXkgYW5kIHRoZSBuZXcgc2hpcFxuICAgICAgcmV0dXJuIHsgcG9zaXRpb25BcnJheSwgc2hpcCB9O1xuICAgIH1cbiAgfTtcblxuICAvLyBIYW5kbGUgbG9naWMgd2hlbiBhIGJvYXJkIHNxdWFyZSBpcyBhdHRhY2tlZFxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHZpc2l0ZWRBcnJheSwgeCwgeSkgPT4ge1xuICAgIC8vIFRocm93IGVycm9yIGlmIHRoZSBzcXVhcmUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkXG4gICAgaWYgKFxuICAgICAgdmlzaXRlZEFycmF5LnNvbWUoKGVsZW1lbnQpID0+IEpTT04uc3RyaW5naWZ5KGVsZW1lbnQpID09PSBgWyR7eH0sJHt5fV1gKVxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGxlYXNlIGNob29zZSBhbiB1bnZpc2l0ZWQgc3F1YXJlXCIpO1xuICAgIH1cblxuICAgIC8vIE90aGVyd2lzZSBpZiBpdCdzIGEgaGl0LCBpbnZva2UgaGl0IG1ldGhvZCBvZiBzaGlwIGFuZCByZXR1cm4gdHJ1ZVxuICAgIGxldCBpc0hpdCA9IGZhbHNlO1xuICAgIGJvYXJkT2JqZWN0cy5mb3JFYWNoKChvYmopID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgb2JqLnBvc2l0aW9uQXJyYXkuZmluZChcbiAgICAgICAgICAoZWxlbWVudCkgPT4gSlNPTi5zdHJpbmdpZnkoZWxlbWVudCkgPT09IGBbJHt4fSwke3l9XWAsXG4gICAgICAgIClcbiAgICAgICkge1xuICAgICAgICBvYmouc2hpcC5oaXQoKTtcbiAgICAgICAgaXNIaXQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQWRkIHRoZSBzcXVhcmUgdG8gdGhlIHZpc2l0ZWQgYXJyYXlcbiAgICB2aXNpdGVkQXJyYXkucHVzaChbeCwgeV0pO1xuXG4gICAgcmV0dXJuIGlzSGl0O1xuICB9O1xuXG4gIC8vIENoZWNrIGlmIGFsbCB0aGUgc2hpcHMgb24gdGhlIGJvYXJkIGFyZSBzdW5rXG4gIGNvbnN0IGNoZWNrQWxsU3VuayA9ICgpID0+IHtcbiAgICBsZXQgYWxsU3VuayA9IHRydWU7XG4gICAgYm9hcmRPYmplY3RzLmZvckVhY2goKG9iaikgPT4ge1xuICAgICAgaWYgKG9iai5zaGlwLmlzU3VuaygpID09PSBmYWxzZSkge1xuICAgICAgICBhbGxTdW5rID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGFsbFN1bms7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBncmlkU2l6ZSxcbiAgICBwbGFjZVNoaXAsXG4gICAgY2hlY2tFbXB0eSxcbiAgICBib2FyZE9iamVjdHMsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBjaGVja0FsbFN1bmssXG4gIH07XG59O1xuIiwiaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkLmpzXCI7XG5cbmV4cG9ydCBjb25zdCBQbGF5ZXIgPSAobmFtZSwgYXJyYXkgPSBbXSkgPT4ge1xuICAvLyBFYWNoIHBsYXllciBuZWVkcyB0aGVpciBvd24gR2FtZWJvYXJkIG9iamVjdFxuICBjb25zdCBib2FyZCA9IEdhbWVib2FyZCgpO1xuXG4gIC8vIEludm9rZSByZWNlaXZlQXR0YWNrIG9uIHRoZSBwcm92aWRlZCBib2FyZFxuICBjb25zdCBhdHRhY2sgPSAocGxheWVyQm9hcmQsIHgsIHksIHZpc2l0ZWRBcnJheSA9IGFycmF5KSA9PiB7XG4gICAgcmV0dXJuIHBsYXllckJvYXJkLnJlY2VpdmVBdHRhY2sodmlzaXRlZEFycmF5LCB4LCB5KTtcbiAgfTtcblxuICAvLyBTb21lIGdlbmVyYWwgaG91c2VrZWVwaW5nIHZhcmlhYmxlc1xuICBsZXQgaHVudGVyTW9kZSA9IGZhbHNlO1xuICBsZXQgbGluZWFySHVudCA9IGZhbHNlO1xuICBsZXQgc3Vua0xlbmd0aCA9IDA7XG5cbiAgY29uc3QgaGl0QXJyYXkgPSBbXTtcbiAgbGV0IHRhcmdldEFycmF5ID0gW107XG5cbiAgLy8gRGVmaW5lIHBhcmFtZXRlcnMgdG8gZmlsdGVyIG91dCBpbnZhbGlkIHNob3RzXG4gIGNvbnN0IGZpbHRlclBhcmFtcyA9IChhcnIsIHZpc2l0ZWRBcnJheSkgPT5cbiAgICBhcnJbMF0gPj0gMCAmJlxuICAgIGFyclswXSA8PSBib2FyZC5ncmlkU2l6ZSAmJlxuICAgIGFyclsxXSA+PSAwICYmXG4gICAgYXJyWzFdIDw9IGJvYXJkLmdyaWRTaXplICYmXG4gICAgIUpTT04uc3RyaW5naWZ5KHZpc2l0ZWRBcnJheSkuaW5jbHVkZXMoYCR7SlNPTi5zdHJpbmdpZnkoYXJyKX1gKTtcblxuICBjb25zdCBnZXRIdW50ZXJNb2RlID0gKCkgPT4gaHVudGVyTW9kZTtcblxuICAvLyBHZW5lcmF0ZSByYW5kb20gdmFsdWVzIGZvciBjb21wdXRlckF0dGFjayAqKlVQR1JBREUgVEhJUyBMQVRFUioqXG4gIGNvbnN0IGdldFJhbmRvbVZhbHVlID0gKCkgPT4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGJvYXJkLmdyaWRTaXplICsgMSkpO1xuXG4gIGNvbnN0IGNvbXB1dGVyQXR0YWNrID0gKFxuICAgIHBsYXllckJvYXJkLFxuICAgIHggPSBnZXRSYW5kb21WYWx1ZSgpLFxuICAgIHkgPSBnZXRSYW5kb21WYWx1ZSgpLFxuICAgIHZpc2l0ZWRBcnJheSA9IGFycmF5LFxuICApID0+IHtcbiAgICBsZXQgaXNIaXQgPSBmYWxzZTtcblxuICAgIC8vIER1cmluZyByYW5kb20gc2VhcmNoXG4gICAgaWYgKGh1bnRlck1vZGUgPT09IGZhbHNlKSB7XG4gICAgICAvLyBJZiB0aGUgcmFuZG9tIHNwYWNlIGhhcyBiZWVuIHZpc2l0ZWQsIHJlcm9sbCB1bnRpbCBhIG5ldyBzcGFjZSBpcyBmb3VuZFxuICAgICAgd2hpbGUgKFxuICAgICAgICB2aXNpdGVkQXJyYXkuc29tZShcbiAgICAgICAgICAoZWxlbWVudCkgPT4gSlNPTi5zdHJpbmdpZnkoZWxlbWVudCkgPT09IGBbJHt4fSwke3l9XWAsXG4gICAgICAgIClcbiAgICAgICkge1xuICAgICAgICB4ID0gZ2V0UmFuZG9tVmFsdWUoKTtcbiAgICAgICAgeSA9IGdldFJhbmRvbVZhbHVlKCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwbGF5ZXJCb2FyZC5yZWNlaXZlQXR0YWNrKHZpc2l0ZWRBcnJheSwgeCwgeSkpIHtcbiAgICAgICAgaXNIaXQgPSB0cnVlO1xuXG4gICAgICAgIHBsYXllckJvYXJkLmJvYXJkT2JqZWN0cy5mb3JFYWNoKChvYmopID0+IHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBvYmoucG9zaXRpb25BcnJheS5zb21lKFxuICAgICAgICAgICAgICAoZWxlbWVudCkgPT4gSlNPTi5zdHJpbmdpZnkoZWxlbWVudCkgPT09IGBbJHt4fSwke3l9XWAsXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICAvKiogSWYgdGhlIGhpdCBzaW5rcyB0aGUgc2hpcCwgZG8gbm90IGFjdGl2YXRlIGh1bnRlciBtb2RlLFxuICAgICAgICAgICAgICogIG90aGVyd2lzZSBiZWdpbiBodW50aW5nIGxvZ2ljICovXG4gICAgICAgICAgICBpZiAob2JqLnNoaXAuaXNTdW5rKCkpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdW5rIGVtIVwiKTtcbiAgICAgICAgICAgICAgaHVudGVyTW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaHVudGVyTW9kZSA9IHRydWU7XG4gICAgICAgICAgICAgIGxpbmVhckh1bnQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgIGhpdEFycmF5LnB1c2goW3gsIHldKTtcblxuICAgICAgICAgICAgICBjb25zdCBhZGphY2VuY3lBcnJheSA9IFtcbiAgICAgICAgICAgICAgICBbeCAtIDEsIHldLFxuICAgICAgICAgICAgICAgIFt4ICsgMSwgeV0sXG4gICAgICAgICAgICAgICAgW3gsIHkgLSAxXSxcbiAgICAgICAgICAgICAgICBbeCwgeSArIDFdLFxuICAgICAgICAgICAgICBdLmZpbHRlcigoYXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlclBhcmFtcyhhcnIsIHZpc2l0ZWRBcnJheSk7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGFkamFjZW5jeUFycmF5LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0YXJnZXRBcnJheS5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkuc29ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8qKiBQYXNzIHZhbHVlcyBiYWNrIHRvIGZvciB0aGUgRE9NIG1hbmlwdWxhdGluZyBjb2RlIHRvIHByb2Nlc3MgKi9cbiAgICAgIHJldHVybiBbaXNIaXQsIHgsIHldO1xuICAgIH0gZWxzZSBpZiAoaHVudGVyTW9kZSA9PT0gdHJ1ZSkge1xuICAgICAgdGFyZ2V0QXJyYXkuc29ydCgpO1xuXG4gICAgICBpZiAodGFyZ2V0QXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGxpbmVhckh1bnQgPSBmYWxzZTtcblxuICAgICAgICBoaXRBcnJheS5mb3JFYWNoKChhcnIpID0+IHtcbiAgICAgICAgICBjb25zdCBuZXdUYXJnZXRzID0gW1xuICAgICAgICAgICAgW2FyclswXSAtIDEsIGFyclsxXV0sXG4gICAgICAgICAgICBbYXJyWzBdICsgMSwgYXJyWzFdXSxcbiAgICAgICAgICAgIFthcnJbMF0sIGFyclsxXSAtIDFdLFxuICAgICAgICAgICAgW2FyclswXSwgYXJyWzFdICsgMV0sXG4gICAgICAgICAgXTtcbiAgICAgICAgICBuZXdUYXJnZXRzLmZvckVhY2goKGFycikgPT4gdGFyZ2V0QXJyYXkucHVzaChhcnIpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEZpbHRlciBvdXQgYW55IGludmFsaWQgdGFyZ2V0cyBpbiB0aGUgYXJyYXlcbiAgICAgIHRhcmdldEFycmF5ID0gdGFyZ2V0QXJyYXkuZmlsdGVyKChhcnIpID0+IHtcbiAgICAgICAgcmV0dXJuIGZpbHRlclBhcmFtcyhhcnIsIHZpc2l0ZWRBcnJheSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gUGljayBhIHRhcmdldCBhdCByYW5kb20gZnJvbSB0aGUgdmFsaWQgdGFyZ2V0c1xuICAgICAgbGV0IHRhcmdldCA9IHRhcmdldEFycmF5W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRhcmdldEFycmF5Lmxlbmd0aCldO1xuXG4gICAgICAvLyBIYW5kbGUgbG9naWMgaWYgdGhlIGF0dGFjayBpcyBhIGhpdFxuICAgICAgaWYgKHBsYXllckJvYXJkLnJlY2VpdmVBdHRhY2sodmlzaXRlZEFycmF5LCB0YXJnZXRbMF0sIHRhcmdldFsxXSkpIHtcbiAgICAgICAgaXNIaXQgPSB0cnVlO1xuXG4gICAgICAgIGhpdEFycmF5LnB1c2godGFyZ2V0KTtcblxuICAgICAgICBwbGF5ZXJCb2FyZC5ib2FyZE9iamVjdHMuZm9yRWFjaCgob2JqKSA9PiB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgb2JqLnBvc2l0aW9uQXJyYXkuc29tZShcbiAgICAgICAgICAgICAgKGVsZW1lbnQpID0+XG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoZWxlbWVudCkgPT09IGBbJHt0YXJnZXRbMF19LCR7dGFyZ2V0WzFdfV1gLFxuICAgICAgICAgICAgKVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGhpdCBzaW5rcyB0aGUgc2hpcCxkZWFjdGl2YXRlIGh1bnRlciBtb2RlLFxuICAgICAgICAgICAgaWYgKG9iai5zaGlwLmlzU3VuaygpKSB7XG4gICAgICAgICAgICAgIHN1bmtMZW5ndGggKz0gb2JqLnNoaXAuc2l6ZTtcblxuICAgICAgICAgICAgICBpZiAoc3Vua0xlbmd0aCA9PT0gaGl0QXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaHVudGVyTW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGxpbmVhckh1bnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBzdW5rTGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICBoaXRBcnJheS5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIHRhcmdldEFycmF5Lmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIElmIHRoZSBoaXQgZG9lc24ndCB0dXJuIG9mZiBodW50ZXIgbW9kZSwgY29udGludWUgaHVudGluZyBsb2dpY1xuICAgICAgICBpZiAoaHVudGVyTW9kZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIGhpdEFycmF5LnNvcnQoKTtcblxuICAgICAgICAgIGlmIChsaW5lYXJIdW50ID09PSB0cnVlKSB7XG4gICAgICAgICAgICB0YXJnZXRBcnJheS5sZW5ndGggPSAwO1xuICAgICAgICAgICAgaWYgKGhpdEFycmF5WzBdWzBdID09PSBoaXRBcnJheVsxXVswXSkge1xuICAgICAgICAgICAgICB0YXJnZXRBcnJheS5wdXNoKFxuICAgICAgICAgICAgICAgIFtoaXRBcnJheVswXVswXSwgaGl0QXJyYXlbMF1bMV0gLSAxXSxcbiAgICAgICAgICAgICAgICBbaGl0QXJyYXlbMF1bMF0sIGhpdEFycmF5W2hpdEFycmF5Lmxlbmd0aCAtIDFdWzFdICsgMV0sXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGhpdEFycmF5WzBdWzFdID09PSBoaXRBcnJheVswXVsxXSkge1xuICAgICAgICAgICAgICB0YXJnZXRBcnJheS5wdXNoKFxuICAgICAgICAgICAgICAgIFtoaXRBcnJheVswXVswXSAtIDEsIGhpdEFycmF5WzBdWzFdXSxcbiAgICAgICAgICAgICAgICBbaGl0QXJyYXlbaGl0QXJyYXkubGVuZ3RoIC0gMV1bMF0gKyAxLCBoaXRBcnJheVswXVsxXV0sXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRmlsdGVyIG91dCBhbnkgaW52YWxpZCB0YXJnZXRzXG4gICAgICAgICAgdGFyZ2V0QXJyYXkgPSB0YXJnZXRBcnJheS5maWx0ZXIoKGFycikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlclBhcmFtcyhhcnIsIHZpc2l0ZWRBcnJheSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE9uIGEgbWlzcywgcmVtb3ZlIHRoYXQgaXRlbSBmcm9tIHRoZSB0YXJnZXQgYXJyYXlcbiAgICAgICAgdGFyZ2V0QXJyYXkuc3BsaWNlKHRhcmdldEFycmF5LmluZGV4T2YodGFyZ2V0KSwgMSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJldHVybiB3aGV0aGVyIGl0IHdhcyBhIGhpdCBvciBub3QgYW5kIGxvY2F0aW9uIGZvciBzdHlsaW5nIHB1cnBvc2VzXG4gICAgICByZXR1cm4gW2lzSGl0LCB0YXJnZXRbMF0sIHRhcmdldFsxXV07XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgbmFtZSxcbiAgICBnZXQgdmlzaXRlZEFycmF5KCkge1xuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH0sXG4gICAgYm9hcmQsXG4gICAgYXR0YWNrLFxuICAgIGhpdEFycmF5LFxuICAgIHRhcmdldEFycmF5LFxuICAgIGNvbXB1dGVyQXR0YWNrLFxuICAgIGdldEh1bnRlck1vZGUsXG4gIH07XG59O1xuIiwiLy8gU2ltcGxlIGhlbHBlciBtb2R1bGUgZm9yIGNsZWFyaW5nIERPTSBjaGlsZHJlblxuZXhwb3J0IGNvbnN0IGNsZWFyQ2hpbGRyZW4gPSAobm9kZSkgPT4ge1xuICB3aGlsZSAobm9kZS5maXJzdENoaWxkKSB7XG4gICAgbm9kZS5yZW1vdmVDaGlsZChub2RlLmxhc3RDaGlsZCk7XG4gIH1cbn07XG4iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmQuanNcIjtcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllci5qc1wiO1xuaW1wb3J0IHsgY2xlYXJDaGlsZHJlbiB9IGZyb20gXCIuL2NsZWFyY2hpbGRyZW4uanNcIjtcbmltcG9ydCBcIi4vc3R5bGUuY3NzXCI7XG5pbXBvcnQgd2F2ZXMgZnJvbSBcIi4vaW1hZ2VzL3dhdmVzLmpwZ1wiO1xuaW1wb3J0IGZpdmVTaGlwIGZyb20gXCIuL2ltYWdlcy9maXZlc2hpcC5wbmdcIjtcbmltcG9ydCBmb3VyU2hpcCBmcm9tIFwiLi9pbWFnZXMvZm91cnNoaXAucG5nXCI7XG5pbXBvcnQgdGhyZWVTaGlwIGZyb20gXCIuL2ltYWdlcy90aHJlZXNoaXAucG5nXCI7XG5pbXBvcnQgdHdvU2hpcCBmcm9tIFwiLi9pbWFnZXMvdHdvc2hpcC5wbmdcIjtcblxuY29uc3QgaG9tZUxvYWQgPSAoKSA9PiB7XG4gIC8qKiBHcmFiL2NyZWF0ZSBET00gZWxlbWVudHMgKi9cbiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7XG5cbiAgY29uc3QgbW9kYWxDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBtb2RlTW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBtb2RlTWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IG1vZGVCdXR0b25Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBvbmVQbGF5ZXJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICBjb25zdCB0d29QbGF5ZXJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuXG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGhlYWRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGVudFwiKTtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgY29uc3QgbmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGxlZnROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgcmlnaHROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICBjb25zdCBib2FyZENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGxlZnRTaGlwVHJheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGxlZnRDYXJyaWVyTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBsZWZ0QmF0dGxlc2hpcExhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgbGVmdENydWlzZXJMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGxlZnRTdWJtYXJpbmVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGxlZnREZXN0cm95ZXJMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGxlZnRCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IHJpZ2h0Qm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCByaWdodFNoaXBUcmF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgcmlnaHRDYXJyaWVyTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCByaWdodEJhdHRsZXNoaXBMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IHJpZ2h0Q3J1aXNlckxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgcmlnaHRTdWJtYXJpbmVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IHJpZ2h0RGVzdHJveWVyTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG4gIGNvbnN0IGhlbHBUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICBjb25zdCBpbnRlcnN0aXRpYWxNb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGludGVyc3RpdGlhbFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCByZWFkeUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cbiAgY29uc3QgZXJyb3JNb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGVycm9yVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGVycm9yQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcblxuICBjb25zdCBlbmRNb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGVuZFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCByZXNldEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cbiAgY29uc3QgZm9vdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGZvb3RlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgY29uc3Qgd2F2ZXNJbWFnZSA9IG5ldyBJbWFnZSgpO1xuICBjb25zdCBsZWZ0Q2FycmllckltYWdlID0gbmV3IEltYWdlKCk7XG4gIGNvbnN0IGxlZnRCYXR0bGVzaGlwSW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgY29uc3QgbGVmdENydWlzZXJJbWFnZSA9IG5ldyBJbWFnZSgpO1xuICBjb25zdCBsZWZ0U3VibWFyaW5lSW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgY29uc3QgbGVmdERlc3Ryb3llckltYWdlID0gbmV3IEltYWdlKCk7XG4gIGNvbnN0IHJpZ2h0Q2FycmllckltYWdlID0gbmV3IEltYWdlKCk7XG4gIGNvbnN0IHJpZ2h0QmF0dGxlc2hpcEltYWdlID0gbmV3IEltYWdlKCk7XG4gIGNvbnN0IHJpZ2h0Q3J1aXNlckltYWdlID0gbmV3IEltYWdlKCk7XG4gIGNvbnN0IHJpZ2h0U3VibWFyaW5lSW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgY29uc3QgcmlnaHREZXN0cm95ZXJJbWFnZSA9IG5ldyBJbWFnZSgpO1xuXG4gIC8qKiBBc3NpZ24gaW1hZ2Ugc291cmNlcyAqL1xuICB3YXZlc0ltYWdlLnNyYyA9IHdhdmVzO1xuICBsZWZ0Q2FycmllckltYWdlLnNyYyA9IGZpdmVTaGlwO1xuICBsZWZ0QmF0dGxlc2hpcEltYWdlLnNyYyA9IGZvdXJTaGlwO1xuICBsZWZ0Q3J1aXNlckltYWdlLnNyYyA9IHRocmVlU2hpcDtcbiAgbGVmdFN1Ym1hcmluZUltYWdlLnNyYyA9IHRocmVlU2hpcDtcbiAgbGVmdERlc3Ryb3llckltYWdlLnNyYyA9IHR3b1NoaXA7XG4gIHJpZ2h0Q2FycmllckltYWdlLnNyYyA9IGZpdmVTaGlwO1xuICByaWdodEJhdHRsZXNoaXBJbWFnZS5zcmMgPSBmb3VyU2hpcDtcbiAgcmlnaHRDcnVpc2VySW1hZ2Uuc3JjID0gdGhyZWVTaGlwO1xuICByaWdodFN1Ym1hcmluZUltYWdlLnNyYyA9IHRocmVlU2hpcDtcbiAgcmlnaHREZXN0cm95ZXJJbWFnZS5zcmMgPSB0d29TaGlwO1xuXG4gIC8qKiBBZGQgQ1NTIHNlbGVjdG9ycyAqL1xuICBtb2RhbENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibW9kYWxjb250YWluZXJcIik7XG4gIG1vZGVNb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxcIik7XG4gIG1vZGVNZXNzYWdlLmNsYXNzTGlzdC5hZGQoXCJtb2RlbWVzc2FnZVwiKTtcbiAgbW9kZUJ1dHRvbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibW9kZWJ0bmNvbnRhaW5lclwiKTtcblxuICBoZWFkZXIuY2xhc3NMaXN0LmFkZChcImhlYWRlclwiKTtcbiAgaGVhZENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGVhZGNvbnRhaW5lclwiKTtcbiAgdGl0bGUuY2xhc3NMaXN0LmFkZChcInRpdGxlXCIpO1xuXG4gIG1haW4uY2xhc3NMaXN0LmFkZChcIm1haW5cIik7XG4gIG5hbWVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5hbWVjb250YWluZXJcIik7XG4gIGxlZnROYW1lLmNsYXNzTGlzdC5hZGQoXCJuYW1lXCIpO1xuICByaWdodE5hbWUuY2xhc3NMaXN0LmFkZChcIm5hbWVcIik7XG5cbiAgYm9hcmRDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvYXJkY29udGFpbmVyXCIpO1xuICBsZWZ0Qm9hcmQuY2xhc3NMaXN0LmFkZChcImJvYXJkXCIpO1xuICByaWdodEJvYXJkLmNsYXNzTGlzdC5hZGQoXCJib2FyZFwiKTtcblxuICBsZWZ0U2hpcFRyYXkuY2xhc3NMaXN0LmFkZChcInNoaXB0cmF5XCIpO1xuICBsZWZ0Q2FycmllckltYWdlLmNsYXNzTGlzdC5hZGQoXCJzaGlwaW1hZ2VcIik7XG4gIGxlZnRCYXR0bGVzaGlwSW1hZ2UuY2xhc3NMaXN0LmFkZChcInNoaXBpbWFnZVwiKTtcbiAgbGVmdENydWlzZXJJbWFnZS5jbGFzc0xpc3QuYWRkKFwic2hpcGltYWdlXCIpO1xuICBsZWZ0U3VibWFyaW5lSW1hZ2UuY2xhc3NMaXN0LmFkZChcInNoaXBpbWFnZVwiKTtcbiAgbGVmdERlc3Ryb3llckltYWdlLmNsYXNzTGlzdC5hZGQoXCJzaGlwaW1hZ2VcIik7XG4gIGxlZnRDYXJyaWVyTGFiZWwuY2xhc3NMaXN0LmFkZChcInNoaXBsYWJlbFwiKTtcbiAgbGVmdEJhdHRsZXNoaXBMYWJlbC5jbGFzc0xpc3QuYWRkKFwic2hpcGxhYmVsXCIpO1xuICBsZWZ0Q3J1aXNlckxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzaGlwbGFiZWxcIik7XG4gIGxlZnRTdWJtYXJpbmVMYWJlbC5jbGFzc0xpc3QuYWRkKFwic2hpcGxhYmVsXCIpO1xuICBsZWZ0RGVzdHJveWVyTGFiZWwuY2xhc3NMaXN0LmFkZChcInNoaXBsYWJlbFwiKTtcblxuICByaWdodFNoaXBUcmF5LmNsYXNzTGlzdC5hZGQoXCJzaGlwdHJheVwiKTtcbiAgcmlnaHRDYXJyaWVySW1hZ2UuY2xhc3NMaXN0LmFkZChcInNoaXBpbWFnZVwiKTtcbiAgcmlnaHRCYXR0bGVzaGlwSW1hZ2UuY2xhc3NMaXN0LmFkZChcInNoaXBpbWFnZVwiKTtcbiAgcmlnaHRDcnVpc2VySW1hZ2UuY2xhc3NMaXN0LmFkZChcInNoaXBpbWFnZVwiKTtcbiAgcmlnaHRTdWJtYXJpbmVJbWFnZS5jbGFzc0xpc3QuYWRkKFwic2hpcGltYWdlXCIpO1xuICByaWdodERlc3Ryb3llckltYWdlLmNsYXNzTGlzdC5hZGQoXCJzaGlwaW1hZ2VcIik7XG4gIHJpZ2h0Q2FycmllckxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzaGlwbGFiZWxcIik7XG4gIHJpZ2h0QmF0dGxlc2hpcExhYmVsLmNsYXNzTGlzdC5hZGQoXCJzaGlwbGFiZWxcIik7XG4gIHJpZ2h0Q3J1aXNlckxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzaGlwbGFiZWxcIik7XG4gIHJpZ2h0U3VibWFyaW5lTGFiZWwuY2xhc3NMaXN0LmFkZChcInNoaXBsYWJlbFwiKTtcbiAgcmlnaHREZXN0cm95ZXJMYWJlbC5jbGFzc0xpc3QuYWRkKFwic2hpcGxhYmVsXCIpO1xuXG4gIGhlbHBUZXh0LmNsYXNzTGlzdC5hZGQoXCJoZWxwdGV4dFwiKTtcblxuICBpbnRlcnN0aXRpYWxNb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxcIik7XG4gIGludGVyc3RpdGlhbFRleHQuY2xhc3NMaXN0LmFkZChcImludGVydGV4dFwiKTtcblxuICBlcnJvck1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbFwiLCBcImVycm9yXCIpO1xuICBlcnJvclRleHQuY2xhc3NMaXN0LmFkZChcImVycm9ydGV4dFwiKTtcbiAgZXJyb3JCdXR0b24uY2xhc3NMaXN0LmFkZChcImVycm9yYnRuXCIpO1xuXG4gIGVuZE1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbFwiKTtcbiAgZW5kVGV4dC5jbGFzc0xpc3QuYWRkKFwiZW5kdGV4dFwiKTtcblxuICBmb290Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJmb290Y29udGFpbmVyXCIpO1xuICBmb290ZXIuY2xhc3NMaXN0LmFkZChcImZvb3RlclwiKTtcblxuICAvKiogUG9wdWxhdGUgdGV4dCBjb250ZW50ICovXG4gIHRpdGxlLnRleHRDb250ZW50ID0gXCJCYXR0bGVzaGlwXCI7XG4gIGxlZnRDYXJyaWVyTGFiZWwudGV4dENvbnRlbnQgPSBcIkNhcnJpZXJcIjtcbiAgbGVmdEJhdHRsZXNoaXBMYWJlbC50ZXh0Q29udGVudCA9IFwiQmF0dGxlc2hpcFwiO1xuICBsZWZ0Q3J1aXNlckxhYmVsLnRleHRDb250ZW50ID0gXCJDcnVpc2VyXCI7XG4gIGxlZnRTdWJtYXJpbmVMYWJlbC50ZXh0Q29udGVudCA9IFwiU3VibWFyaW5lXCI7XG4gIGxlZnREZXN0cm95ZXJMYWJlbC50ZXh0Q29udGVudCA9IFwiRGVzdHJveWVyXCI7XG4gIHJpZ2h0Q2FycmllckxhYmVsLnRleHRDb250ZW50ID0gXCJDYXJyaWVyXCI7XG4gIHJpZ2h0QmF0dGxlc2hpcExhYmVsLnRleHRDb250ZW50ID0gXCJCYXR0bGVzaGlwXCI7XG4gIHJpZ2h0Q3J1aXNlckxhYmVsLnRleHRDb250ZW50ID0gXCJDcnVpc2VyXCI7XG4gIHJpZ2h0U3VibWFyaW5lTGFiZWwudGV4dENvbnRlbnQgPSBcIlN1Ym1hcmluZVwiO1xuICByaWdodERlc3Ryb3llckxhYmVsLnRleHRDb250ZW50ID0gXCJEZXN0cm95ZXJcIjtcblxuICBtb2RlTWVzc2FnZS50ZXh0Q29udGVudCA9IFwiU2VsZWN0IGdhbWUgbW9kZTpcIjtcbiAgb25lUGxheWVyQnV0dG9uLnRleHRDb250ZW50ID0gXCJPbmUgUGxheWVyXCI7XG4gIHR3b1BsYXllckJ1dHRvbi50ZXh0Q29udGVudCA9IFwiVHdvIFBsYXllclwiO1xuXG4gIHJlYWR5QnV0dG9uLnRleHRDb250ZW50ID0gXCJSZWFkeVwiO1xuXG4gIGZvb3Rlci50ZXh0Q29udGVudCA9IFwiQnkgTmVhbCBDaGFtcGFnbmU6IE9jdG9iZXIgMjAyNFwiO1xuXG4gIGludGVyc3RpdGlhbE1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgcmVhZHlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlSW50ZXJzdGl0aWFsKHBsYXllclR1cm4pKTtcblxuICBlcnJvck1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgZXJyb3JCdXR0b24udGV4dENvbnRlbnQgPSBcIkNsb3NlXCI7XG4gIGVycm9yQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgZXJyb3JNb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIH0pO1xuXG4gIGVuZE1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgcmVzZXRCdXR0b24udGV4dENvbnRlbnQgPSBcIk5ldyBHYW1lXCI7XG4gIHJlc2V0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBob21lTG9hZCgpKTtcbiAgLyoqIFNldCBiYWNrZ3JvdW5kIGltYWdlcyBmb3IgYm9hcmRzIGFuZCBtYWluIGJvZHkgKi9cbiAgbGVmdEJvYXJkLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt3YXZlc30pYDtcbiAgbGVmdEJvYXJkLnN0eWxlLmJhY2tncm91bmRTaXplID0gXCJjb3ZlclwiO1xuICByaWdodEJvYXJkLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt3YXZlc30pYDtcbiAgcmlnaHRCb2FyZC5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9IFwiY292ZXJcIjtcbiAgYm9keS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7d2F2ZXN9KWA7XG4gIGJvZHkuc3R5bGUuYmFja2dyb3VuZFNpemUgPSBcImNvdmVyXCI7XG5cbiAgLyoqIFdpcGUgdGhlIHNsYXRlIGNsZWFuIGZvciByZXNldHMgKi9cbiAgY2xlYXJDaGlsZHJlbihjb250ZW50KTtcblxuICBtYWluLmFwcGVuZENoaWxkKG1vZGFsQ29udGFpbmVyKTtcbiAgbW9kYWxDb250YWluZXIuYXBwZW5kQ2hpbGQobW9kZU1vZGFsKTtcbiAgbW9kZU1vZGFsLmFwcGVuZENoaWxkKG1vZGVNZXNzYWdlKTtcbiAgbW9kZU1vZGFsLmFwcGVuZENoaWxkKG1vZGVCdXR0b25Db250YWluZXIpO1xuICBtb2RlQnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKG9uZVBsYXllckJ1dHRvbik7XG4gIG1vZGVCdXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQodHdvUGxheWVyQnV0dG9uKTtcblxuICBjb250ZW50LmFwcGVuZENoaWxkKGhlYWRlcik7XG4gIGhlYWRlci5hcHBlbmRDaGlsZChoZWFkQ29udGFpbmVyKTtcbiAgaGVhZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cbiAgY29udGVudC5hcHBlbmRDaGlsZChtYWluKTtcbiAgbWFpbi5hcHBlbmRDaGlsZChuYW1lQ29udGFpbmVyKTtcbiAgbmFtZUNvbnRhaW5lci5hcHBlbmRDaGlsZChsZWZ0TmFtZSk7XG4gIG5hbWVDb250YWluZXIuYXBwZW5kQ2hpbGQocmlnaHROYW1lKTtcblxuICBtYWluLmFwcGVuZENoaWxkKGJvYXJkQ29udGFpbmVyKTtcbiAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQobGVmdFNoaXBUcmF5KTtcbiAgbGVmdFNoaXBUcmF5LmFwcGVuZENoaWxkKGxlZnRDYXJyaWVyTGFiZWwpO1xuICBsZWZ0U2hpcFRyYXkuYXBwZW5kQ2hpbGQobGVmdENhcnJpZXJJbWFnZSk7XG4gIGxlZnRTaGlwVHJheS5hcHBlbmRDaGlsZChsZWZ0QmF0dGxlc2hpcExhYmVsKTtcbiAgbGVmdFNoaXBUcmF5LmFwcGVuZENoaWxkKGxlZnRCYXR0bGVzaGlwSW1hZ2UpO1xuICBsZWZ0U2hpcFRyYXkuYXBwZW5kQ2hpbGQobGVmdENydWlzZXJMYWJlbCk7XG4gIGxlZnRTaGlwVHJheS5hcHBlbmRDaGlsZChsZWZ0Q3J1aXNlckltYWdlKTtcbiAgbGVmdFNoaXBUcmF5LmFwcGVuZENoaWxkKGxlZnRTdWJtYXJpbmVMYWJlbCk7XG4gIGxlZnRTaGlwVHJheS5hcHBlbmRDaGlsZChsZWZ0U3VibWFyaW5lSW1hZ2UpO1xuICBsZWZ0U2hpcFRyYXkuYXBwZW5kQ2hpbGQobGVmdERlc3Ryb3llckxhYmVsKTtcbiAgbGVmdFNoaXBUcmF5LmFwcGVuZENoaWxkKGxlZnREZXN0cm95ZXJJbWFnZSk7XG5cbiAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQobGVmdEJvYXJkKTtcbiAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQocmlnaHRCb2FyZCk7XG5cbiAgYm9hcmRDb250YWluZXIuYXBwZW5kQ2hpbGQocmlnaHRTaGlwVHJheSk7XG4gIHJpZ2h0U2hpcFRyYXkuYXBwZW5kQ2hpbGQocmlnaHRDYXJyaWVyTGFiZWwpO1xuICByaWdodFNoaXBUcmF5LmFwcGVuZENoaWxkKHJpZ2h0Q2FycmllckltYWdlKTtcbiAgcmlnaHRTaGlwVHJheS5hcHBlbmRDaGlsZChyaWdodEJhdHRsZXNoaXBMYWJlbCk7XG4gIHJpZ2h0U2hpcFRyYXkuYXBwZW5kQ2hpbGQocmlnaHRCYXR0bGVzaGlwSW1hZ2UpO1xuICByaWdodFNoaXBUcmF5LmFwcGVuZENoaWxkKHJpZ2h0Q3J1aXNlckxhYmVsKTtcbiAgcmlnaHRTaGlwVHJheS5hcHBlbmRDaGlsZChyaWdodENydWlzZXJJbWFnZSk7XG4gIHJpZ2h0U2hpcFRyYXkuYXBwZW5kQ2hpbGQocmlnaHRTdWJtYXJpbmVMYWJlbCk7XG4gIHJpZ2h0U2hpcFRyYXkuYXBwZW5kQ2hpbGQocmlnaHRTdWJtYXJpbmVJbWFnZSk7XG4gIHJpZ2h0U2hpcFRyYXkuYXBwZW5kQ2hpbGQocmlnaHREZXN0cm95ZXJMYWJlbCk7XG4gIHJpZ2h0U2hpcFRyYXkuYXBwZW5kQ2hpbGQocmlnaHREZXN0cm95ZXJJbWFnZSk7XG5cbiAgbWFpbi5hcHBlbmRDaGlsZChoZWxwVGV4dCk7XG5cbiAgbW9kYWxDb250YWluZXIuYXBwZW5kQ2hpbGQoaW50ZXJzdGl0aWFsTW9kYWwpO1xuICBpbnRlcnN0aXRpYWxNb2RhbC5hcHBlbmRDaGlsZChpbnRlcnN0aXRpYWxUZXh0KTtcbiAgaW50ZXJzdGl0aWFsTW9kYWwuYXBwZW5kQ2hpbGQocmVhZHlCdXR0b24pO1xuXG4gIG1vZGFsQ29udGFpbmVyLmFwcGVuZENoaWxkKGVycm9yTW9kYWwpO1xuICBlcnJvck1vZGFsLmFwcGVuZENoaWxkKGVycm9yVGV4dCk7XG4gIGVycm9yTW9kYWwuYXBwZW5kQ2hpbGQoZXJyb3JCdXR0b24pO1xuXG4gIG1vZGFsQ29udGFpbmVyLmFwcGVuZENoaWxkKGVuZE1vZGFsKTtcbiAgZW5kTW9kYWwuYXBwZW5kQ2hpbGQoZW5kVGV4dCk7XG4gIGVuZE1vZGFsLmFwcGVuZENoaWxkKHJlc2V0QnV0dG9uKTtcblxuICBjb250ZW50LmFwcGVuZENoaWxkKGZvb3RDb250YWluZXIpO1xuICBmb290Q29udGFpbmVyLmFwcGVuZENoaWxkKGZvb3Rlcik7XG5cbiAgLyoqIEluaXRpYWxpemUgbmVjZXNzYXJ5IHZhcmlhYmxlcyBhbmQgYXJyYXlzICovXG4gIGxldCBwdnBNb2RlID0gZmFsc2U7XG4gIGxldCBzZXR1cFBoYXNlID0gZmFsc2U7XG4gIGxldCBiYXR0bGVQaGFzZSA9IGZhbHNlO1xuXG4gIGxldCBwbGF5ZXIxO1xuICBsZXQgcGxheWVyMjtcblxuICBsZXQgcGxhY2VDYXJyaWVyID0gZmFsc2U7XG4gIGxldCBwbGFjZUJhdHRsZXNoaXAgPSBmYWxzZTtcbiAgbGV0IHBsYWNlQ3J1aXNlciA9IGZhbHNlO1xuICBsZXQgcGxhY2VTdWJtYXJpbmUgPSBmYWxzZTtcbiAgbGV0IHBsYWNlRGVzdHJveWVyID0gZmFsc2U7XG5cbiAgbGV0IHBsYWNlRGlyZWN0aW9uID0gXCJob3Jpem9udGFsXCI7XG4gIGxldCBob3ZlclRhcmdldDtcblxuICBjb25zdCBwbGF5ZXJPbmVTcXVhcmVzID0gW107XG4gIGNvbnN0IHBsYXllclR3b1NxdWFyZXMgPSBbXTtcbiAgY29uc3QgdmlzaXRlZEFycmF5MSA9IFtdO1xuICBjb25zdCB2aXNpdGVkQXJyYXkyID0gW107XG5cbiAgbGV0IHBsYXllclR1cm4gPSBcInBsYXllcjFcIjtcblxuICAvKiogQ2xvc2UgbW9kZS1zZWxlY3QgbW9kYWwgYW5kIGJlZ2luIHNldHVwICovXG4gIGNvbnN0IGNsb3NlTW9kZU1vZGFsID0gKCkgPT4ge1xuICAgIGlmIChwdnBNb2RlKSB7XG4gICAgICBsZWZ0TmFtZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIDFcIjtcbiAgICAgIHJpZ2h0TmFtZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIDJcIjtcbiAgICAgIGhlbHBUZXh0LnRleHRDb250ZW50ID0gYFRha2UgdHVybnMgcGxhY2luZyBzaGlwcyBieSBjbGlja2luZyBvbiB0aGUgZGVzaXJlZCBzcXVhcmUuXG4gICAgICBQcmVzcyBzcGFjZWJhciB0byByb3RhdGUgc2hpcC4gRG9uJ3QgbGV0IHRoZSBvdGhlciBwbGF5ZXIgd2F0Y2ggd2hpbGUgeW91IHBvc2l0aW9uIHlvdXIgZmxlZXQhYDtcbiAgICAgIHJpZ2h0Qm9hcmQuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuICAgIH0gZWxzZSBpZiAoIXB2cE1vZGUpIHtcbiAgICAgIGhlbHBUZXh0LnRleHRDb250ZW50ID0gYFBsYWNlIHlvdXIgc2hpcHMgYnkgY2xpY2tpbmcgb24gdGhlIGRlc2lyZWQgc3F1YXJlLlxuICAgICAgUHJlc3Mgc3BhY2ViYXIgdG8gcm90YXRlIHNoaXAuYDtcbiAgICB9XG4gICAgbGVmdEJvYXJkLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImF1dG9cIjtcbiAgICBtb2RlTW9kYWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIHNldHVwUGhhc2UgPSB0cnVlO1xuICAgIHBsYWNlQ2FycmllciA9IHRydWU7XG4gIH07XG5cbiAgLyoqIFByb2NlZGUgdG8gMS1wbGF5ZXIgZ2FtZSBhbmQgY2xvc2UgbW9kYWwgKi9cbiAgb25lUGxheWVyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHZwTW9kZSA9IGZhbHNlO1xuICAgIGNsb3NlTW9kZU1vZGFsKCk7XG4gIH0pO1xuXG4gIC8qKiBBY3RpdmF0ZSBQdlAgYW5kIGNsb3NlIG1vZGFsICovXG4gIHR3b1BsYXllckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHB2cE1vZGUgPSB0cnVlO1xuICAgIGNsb3NlTW9kZU1vZGFsKCk7XG4gIH0pO1xuXG4gIC8qKiBMaXN0ZW4gZm9yIHNwYWNlYmFyIHRvIHJvdGF0ZSBzaGlwIHBsYWNlbWVudCAqL1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZlbnQpID0+IHtcbiAgICBpZiAoc2V0dXBQaGFzZSAmJiBldmVudC5jb2RlID09PSBcIlNwYWNlXCIpIHtcbiAgICAgIHBsYWNlRGlyZWN0aW9uID1cbiAgICAgICAgcGxhY2VEaXJlY3Rpb24gPT09IFwiaG9yaXpvbnRhbFwiID8gXCJ2ZXJ0aWNhbFwiIDogXCJob3Jpem9udGFsXCI7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgLyoqIEFkZCAnaGl0JyBjbGFzcyBvbiBoaXQgKi9cbiAgY29uc3QgaGl0U3F1YXJlID0gKHNxdWFyZSkgPT4ge1xuICAgIHNxdWFyZS50ZXh0Q29udGVudCA9IFwiWFwiO1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xuICB9O1xuXG4gIC8qKiBBZGQgJ21pc3MnIGNsYXNzIG9uIG1pc3MgKi9cbiAgY29uc3QgbWlzc1NxdWFyZSA9IChzcXVhcmUpID0+IHtcbiAgICBzcXVhcmUudGV4dENvbnRlbnQgPSBcIk9cIjtcbiAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XG4gIH07XG5cbiAgLyoqIENoZWNrIGZvciBzdW5rIHNoaXBzIGFmdGVyIGF0dGFja2luZywgdXBkYXRlIENTUyBhcyBuZWNlc3NhcnkgKi9cbiAgY29uc3QgbWFya1N1bmtTaGlwcyA9IChwbGF5ZXIsIGJvYXJkKSA9PiB7XG4gICAgcGxheWVyLmJvYXJkLmJvYXJkT2JqZWN0cy5mb3JFYWNoKChvYmopID0+IHtcbiAgICAgIGlmIChvYmouc2hpcC5pc1N1bmsoKVswXSA9PT0gXCJjYXJyaWVyXCIpIHtcbiAgICAgICAgaWYgKGJvYXJkID09PSBsZWZ0Qm9hcmQpIHtcbiAgICAgICAgICBsZWZ0Q2FycmllckltYWdlLmNsYXNzTGlzdC5hZGQoXCJzdW5rc2hpcFwiKTtcbiAgICAgICAgICBsZWZ0Q2FycmllckxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzdW5rbGFiZWxcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmlnaHRDYXJyaWVySW1hZ2UuY2xhc3NMaXN0LmFkZChcInN1bmtzaGlwXCIpO1xuICAgICAgICAgIHJpZ2h0Q2FycmllckxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzdW5rbGFiZWxcIik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAob2JqLnNoaXAuaXNTdW5rKClbMF0gPT09IFwiYmF0dGxlc2hpcFwiKSB7XG4gICAgICAgIGlmIChib2FyZCA9PT0gbGVmdEJvYXJkKSB7XG4gICAgICAgICAgbGVmdEJhdHRsZXNoaXBJbWFnZS5jbGFzc0xpc3QuYWRkKFwic3Vua3NoaXBcIik7XG4gICAgICAgICAgbGVmdEJhdHRsZXNoaXBMYWJlbC5jbGFzc0xpc3QuYWRkKFwic3Vua2xhYmVsXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJpZ2h0QmF0dGxlc2hpcEltYWdlLmNsYXNzTGlzdC5hZGQoXCJzdW5rc2hpcFwiKTtcbiAgICAgICAgICByaWdodEJhdHRsZXNoaXBMYWJlbC5jbGFzc0xpc3QuYWRkKFwic3Vua2xhYmVsXCIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG9iai5zaGlwLmlzU3VuaygpWzBdID09PSBcImNydWlzZXJcIikge1xuICAgICAgICBpZiAoYm9hcmQgPT09IGxlZnRCb2FyZCkge1xuICAgICAgICAgIGxlZnRDcnVpc2VySW1hZ2UuY2xhc3NMaXN0LmFkZChcInN1bmtzaGlwXCIpO1xuICAgICAgICAgIGxlZnRDcnVpc2VyTGFiZWwuY2xhc3NMaXN0LmFkZChcInN1bmtsYWJlbFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByaWdodENydWlzZXJJbWFnZS5jbGFzc0xpc3QuYWRkKFwic3Vua3NoaXBcIik7XG4gICAgICAgICAgcmlnaHRDcnVpc2VyTGFiZWwuY2xhc3NMaXN0LmFkZChcInN1bmtsYWJlbFwiKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChvYmouc2hpcC5pc1N1bmsoKVswXSA9PT0gXCJzdWJtYXJpbmVcIikge1xuICAgICAgICBpZiAoYm9hcmQgPT09IGxlZnRCb2FyZCkge1xuICAgICAgICAgIGxlZnRTdWJtYXJpbmVJbWFnZS5jbGFzc0xpc3QuYWRkKFwic3Vua3NoaXBcIik7XG4gICAgICAgICAgbGVmdFN1Ym1hcmluZUxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzdW5rbGFiZWxcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmlnaHRTdWJtYXJpbmVJbWFnZS5jbGFzc0xpc3QuYWRkKFwic3Vua3NoaXBcIik7XG4gICAgICAgICAgcmlnaHRTdWJtYXJpbmVMYWJlbC5jbGFzc0xpc3QuYWRkKFwic3Vua2xhYmVsXCIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG9iai5zaGlwLmlzU3VuaygpWzBdID09PSBcImRlc3Ryb3llclwiKSB7XG4gICAgICAgIGlmIChib2FyZCA9PT0gbGVmdEJvYXJkKSB7XG4gICAgICAgICAgbGVmdERlc3Ryb3llckltYWdlLmNsYXNzTGlzdC5hZGQoXCJzdW5rc2hpcFwiKTtcbiAgICAgICAgICBsZWZ0RGVzdHJveWVyTGFiZWwuY2xhc3NMaXN0LmFkZChcInN1bmtsYWJlbFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByaWdodERlc3Ryb3llckltYWdlLmNsYXNzTGlzdC5hZGQoXCJzdW5rc2hpcFwiKTtcbiAgICAgICAgICByaWdodERlc3Ryb3llckxhYmVsLmNsYXNzTGlzdC5hZGQoXCJzdW5rbGFiZWxcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvKiogR2VuZXJhdGUgYm9hcmQgc3F1YXJlcyBhbmQgYXR0YWNoIG5lY2Vzc2FyeSBDU1Mgc2VsZWN0b3JzICovXG4gIGNvbnN0IGZpbGxCb2FyZCA9IChwbGF5ZXIsIGJvYXJkLCBlbmVteSkgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgR2FtZWJvYXJkKCkuZ3JpZFNpemUgKyAxOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgR2FtZWJvYXJkKCkuZ3JpZFNpemUgKyAxOyBqKyspIHtcbiAgICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgYCR7cGxheWVyLm5hbWV9JHtqfSR7aX1gKTtcbiAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyLm5hbWV9YCwgXCJzcXVhcmVcIik7XG5cbiAgICAgICAgaWYgKCFwdnBNb2RlKSB7XG4gICAgICAgICAgaWYgKHBsYXllci5uYW1lID09PSBcInBsYXllcjJcIikge1xuICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJmb2dvZndhclwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG4gICAgICAgICAgaG92ZXJUYXJnZXQgPSBzcXVhcmU7XG4gICAgICAgICAgbGV0IHNpemU7XG4gICAgICAgICAgaWYgKHNldHVwUGhhc2UpIHtcbiAgICAgICAgICAgIGlmIChwbGFjZUNhcnJpZXIpIHtcbiAgICAgICAgICAgICAgc2l6ZSA9IDU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlQmF0dGxlc2hpcCkge1xuICAgICAgICAgICAgICBzaXplID0gNDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhY2VDcnVpc2VyIHx8IHBsYWNlU3VibWFyaW5lKSB7XG4gICAgICAgICAgICAgIHNpemUgPSAzO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwbGFjZURlc3Ryb3llcikge1xuICAgICAgICAgICAgICBzaXplID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhpZ2hsaWdodFJhbmdlKHBsYXllciwgc2l6ZSwgcGxhY2VEaXJlY3Rpb24sIGosIGkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgaWYgKHNldHVwUGhhc2UgJiYgZXZlbnQuY29kZSA9PT0gXCJTcGFjZVwiKSB7XG4gICAgICAgICAgICBpZiAoaG92ZXJUYXJnZXQgPT09IHNxdWFyZSkge1xuICAgICAgICAgICAgICBsZXQgc2l6ZTtcbiAgICAgICAgICAgICAgaWYgKHBsYWNlQ2Fycmllcikge1xuICAgICAgICAgICAgICAgIHNpemUgPSA1O1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlQmF0dGxlc2hpcCkge1xuICAgICAgICAgICAgICAgIHNpemUgPSA0O1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlQ3J1aXNlciB8fCBwbGFjZVN1Ym1hcmluZSkge1xuICAgICAgICAgICAgICAgIHNpemUgPSAzO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlRGVzdHJveWVyKSB7XG4gICAgICAgICAgICAgICAgc2l6ZSA9IDI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY2xlYXJIaWdobGlnaHQocGxheWVyKTtcbiAgICAgICAgICAgICAgaGlnaGxpZ2h0UmFuZ2UocGxheWVyLCBzaXplLCBwbGFjZURpcmVjdGlvbiwgaiwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHtcbiAgICAgICAgICBpZiAoc2V0dXBQaGFzZSkge1xuICAgICAgICAgICAgY2xlYXJIaWdobGlnaHQocGxheWVyKTtcbiAgICAgICAgICAgIGhvdmVyVGFyZ2V0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKHNldHVwUGhhc2UpIHtcbiAgICAgICAgICAgIGlmIChwbGFjZUNhcnJpZXIpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBwbGFjZU93blNoaXAocGxheWVyLCBcImNhcnJpZXJcIiwgcGxhY2VEaXJlY3Rpb24sIGosIGkpO1xuICAgICAgICAgICAgICAgIHN0ZXBUaHJvdWdoU2V0dXAoKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGxhY2VCYXR0bGVzaGlwKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcGxhY2VPd25TaGlwKHBsYXllciwgXCJiYXR0bGVzaGlwXCIsIHBsYWNlRGlyZWN0aW9uLCBqLCBpKTtcbiAgICAgICAgICAgICAgICBzdGVwVGhyb3VnaFNldHVwKCk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlQ3J1aXNlcikge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHBsYWNlT3duU2hpcChwbGF5ZXIsIFwiY3J1aXNlclwiLCBwbGFjZURpcmVjdGlvbiwgaiwgaSk7XG4gICAgICAgICAgICAgICAgc3RlcFRocm91Z2hTZXR1cCgpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwbGFjZVN1Ym1hcmluZSkge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHBsYWNlT3duU2hpcChwbGF5ZXIsIFwic3VibWFyaW5lXCIsIHBsYWNlRGlyZWN0aW9uLCBqLCBpKTtcbiAgICAgICAgICAgICAgICBzdGVwVGhyb3VnaFNldHVwKCk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlRGVzdHJveWVyKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcGxhY2VPd25TaGlwKHBsYXllciwgXCJkZXN0cm95ZXJcIiwgcGxhY2VEaXJlY3Rpb24sIGosIGkpO1xuICAgICAgICAgICAgICAgIGlmIChwdnBNb2RlICYmIHBsYXllclR1cm4gPT09IFwicGxheWVyMVwiKSB7XG4gICAgICAgICAgICAgICAgICB0b2dnbGVQbGF5ZXJUdXJuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGVuZFNldHVwKHB2cE1vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGJhdHRsZVBoYXNlKSB7XG4gICAgICAgICAgICBpZiAoZW5lbXkuYXR0YWNrKHBsYXllci5ib2FyZCwgaiwgaSkpIHtcbiAgICAgICAgICAgICAgaGl0U3F1YXJlKHNxdWFyZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtaXNzU3F1YXJlKHNxdWFyZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QucmVtb3ZlKFwiZm9nb2Z3YXJcIik7XG5cbiAgICAgICAgICAgIG1hcmtTdW5rU2hpcHMocGxheWVyLCBib2FyZCk7XG5cbiAgICAgICAgICAgIGlmIChwbGF5ZXIuYm9hcmQuY2hlY2tBbGxTdW5rKCkpIHtcbiAgICAgICAgICAgICAgZW5kR2FtZShlbmVteSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRvZ2dsZVBsYXllclR1cm4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGJvYXJkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgICAgIHBsYXllci5uYW1lID09PSBcInBsYXllcjFcIlxuICAgICAgICAgID8gcGxheWVyT25lU3F1YXJlcy5wdXNoKHNxdWFyZSlcbiAgICAgICAgICA6IHBsYXllclR3b1NxdWFyZXMucHVzaChzcXVhcmUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKiogSGFuZGxlIHR1cm4gc3dpdGNoaW5nICovXG4gIGNvbnN0IHRvZ2dsZVBsYXllclR1cm4gPSAoKSA9PiB7XG4gICAgaWYgKHB2cE1vZGUpIHtcbiAgICAgIGlmIChzZXR1cFBoYXNlKSB7XG4gICAgICAgIGNvbmNlYWxCb2FyZChwbGF5ZXJPbmVTcXVhcmVzKTtcbiAgICAgICAgcGxheWVyVHdvU3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+XG4gICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5yZW1vdmUoXCJmb2dvZndhclwiKSxcbiAgICAgICAgKTtcbiAgICAgICAgcGxhY2VDYXJyaWVyID0gdHJ1ZTtcbiAgICAgICAgbGVmdEJvYXJkLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcbiAgICAgICAgcmlnaHRCb2FyZC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhdXRvXCI7XG4gICAgICAgIHBsYXllclR1cm4gPSBcInBsYXllcjJcIjtcbiAgICAgIH0gZWxzZSBpZiAoYmF0dGxlUGhhc2UpIHtcbiAgICAgICAgaWYgKHBsYXllclR1cm4gPT09IFwicGxheWVyMVwiKSB7XG4gICAgICAgICAgY29uY2VhbEJvYXJkKHBsYXllck9uZVNxdWFyZXMpO1xuICAgICAgICAgIHBsYXllclR1cm4gPSBcInBsYXllcjJcIjtcbiAgICAgICAgICBzaG93SW50ZXJzdGl0aWFsKHBsYXllclR1cm4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbmNlYWxCb2FyZChwbGF5ZXJUd29TcXVhcmVzKTtcbiAgICAgICAgICBwbGF5ZXJUdXJuID0gXCJwbGF5ZXIxXCI7XG4gICAgICAgICAgc2hvd0ludGVyc3RpdGlhbChwbGF5ZXJUdXJuKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBjb21wdXRlclJlc3VsdCA9IHBsYXllcjIuY29tcHV0ZXJBdHRhY2socGxheWVyMS5ib2FyZCk7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgICAgYHBsYXllcjEke2NvbXB1dGVyUmVzdWx0WzFdfSR7Y29tcHV0ZXJSZXN1bHRbMl19YCxcbiAgICAgICk7XG4gICAgICBpZiAoY29tcHV0ZXJSZXN1bHRbMF0pIHtcbiAgICAgICAgaGl0U3F1YXJlKHNxdWFyZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaXNzU3F1YXJlKHNxdWFyZSk7XG4gICAgICB9XG4gICAgICBtYXJrU3Vua1NoaXBzKHBsYXllcjEsIGxlZnRCb2FyZCk7XG4gICAgICBpZiAocGxheWVyMS5ib2FyZC5jaGVja0FsbFN1bmsoKSkge1xuICAgICAgICBlbmRHYW1lKHBsYXllcjIpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKiogQ3JlYXRlIHR3byBwbGF5ZXJzICovXG4gIGNvbnN0IGluaXRpYWxpemVQbGF5ZXJzID0gKCkgPT4ge1xuICAgIHBsYXllcjEgPSBQbGF5ZXIoXCJwbGF5ZXIxXCIsIHZpc2l0ZWRBcnJheTEpO1xuICAgIHBsYXllcjIgPSBQbGF5ZXIoXCJwbGF5ZXIyXCIsIHZpc2l0ZWRBcnJheTIpO1xuXG4gICAgbGVmdE5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllclwiO1xuICAgIHJpZ2h0TmFtZS50ZXh0Q29udGVudCA9IFwiQ29tcHV0ZXJcIjtcbiAgfTtcblxuICAvKiogU3RlcCBkb3duIHRocm91Z2ggc2hpcCBzaXplIGZvciBzZXR1cCBwdXJwb3NlcyAqL1xuICBjb25zdCBzdGVwVGhyb3VnaFNldHVwID0gKCkgPT4ge1xuICAgIGlmIChwbGFjZUNhcnJpZXIpIHtcbiAgICAgIHBsYWNlQ2FycmllciA9IGZhbHNlO1xuICAgICAgcGxhY2VCYXR0bGVzaGlwID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHBsYWNlQmF0dGxlc2hpcCkge1xuICAgICAgcGxhY2VCYXR0bGVzaGlwID0gZmFsc2U7XG4gICAgICBwbGFjZUNydWlzZXIgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAocGxhY2VDcnVpc2VyKSB7XG4gICAgICBwbGFjZUNydWlzZXIgPSBmYWxzZTtcbiAgICAgIHBsYWNlU3VibWFyaW5lID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHBsYWNlU3VibWFyaW5lKSB7XG4gICAgICBwbGFjZVN1Ym1hcmluZSA9IGZhbHNlO1xuICAgICAgcGxhY2VEZXN0cm95ZXIgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAocGxhY2VEZXN0cm95ZXIpIHtcbiAgICAgIHBsYWNlRGVzdHJveWVyID0gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIC8vIFRyYW5zaXRpb24gb3V0IG9mIHNldHVwIG1vZGVcbiAgY29uc3QgZW5kU2V0dXAgPSAocHZwTW9kZSkgPT4ge1xuICAgIGlmIChwdnBNb2RlKSB7XG4gICAgICBwbGF5ZXJUdXJuID0gXCJwbGF5ZXIxXCI7XG4gICAgICBzaG93SW50ZXJzdGl0aWFsKHBsYXllclR1cm4pO1xuICAgICAgaGVscFRleHQudGV4dENvbnRlbnQgPSBgVGFrZSB0dXJucyBmaXJpbmcgYXQgdGhlIG90aGVyIHBsYXllcidzIFxuICAgICAgYm9hcmQgdW50aWwgb25lIHBsYXllciBzaW5rcyBhbGwgb2YgdGhlIG90aGVyJ3Mgc2hpcHMuYDtcbiAgICB9IGVsc2Uge1xuICAgICAgcGxhY2VDYXJyaWVyID0gdHJ1ZTtcbiAgICAgIHBsYWNlQ29tcHV0ZXJTaGlwcygpO1xuICAgICAgaGVscFRleHQudGV4dENvbnRlbnQgPSBgRmlyZSBhdCB0aGUgY29tcHV0ZXIncyBib2FyZCB1bnRpbCBvbmUgZmxlZXRcbiAgICAgIG9yIHRoZSBvdGhlciBpcyBlbnRpcmVseSBzdW5rLmA7XG4gICAgfVxuICAgIGxlZnRCb2FyZC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgc2V0dXBQaGFzZSA9IGZhbHNlO1xuICAgIGJhdHRsZVBoYXNlID0gdHJ1ZTtcbiAgfTtcblxuICAvLyBSYW5kb21seSBwbGFjZSB0aGUgY29tcHV0ZXIncyBmbGVldCBpbiB2YWxpZCBwb3NpdGlvbnNcbiAgY29uc3QgcGxhY2VDb21wdXRlclNoaXBzID0gKCkgPT4ge1xuICAgIGxldCBwbGFjaW5nU2hpcHMgPSB0cnVlO1xuXG4gICAgd2hpbGUgKHBsYWNpbmdTaGlwcykge1xuICAgICAgcGxhY2VEaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpICogMiA+PSAxID8gXCJob3Jpem9udGFsXCIgOiBcInZlcnRpY2FsXCI7XG4gICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChwbGF5ZXIyLmJvYXJkLmdyaWRTaXplICsgMSkpO1xuICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAocGxheWVyMi5ib2FyZC5ncmlkU2l6ZSArIDEpKTtcbiAgICAgIGNvbnNvbGUubG9nKHBsYWNlRGlyZWN0aW9uLCB4LCB5KTtcblxuICAgICAgaWYgKHBsYWNlQ2Fycmllcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHBsYWNlT3duU2hpcChwbGF5ZXIyLCBcImNhcnJpZXJcIiwgcGxhY2VEaXJlY3Rpb24sIHgsIHkpO1xuICAgICAgICAgIHN0ZXBUaHJvdWdoU2V0dXAoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBEb24ndCBkbyBhbnl0aGluZyBvbiBlcnJvciwganVzdCB0cnkgYWdhaW47XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocGxhY2VCYXR0bGVzaGlwKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcGxhY2VPd25TaGlwKHBsYXllcjIsIFwiYmF0dGxlc2hpcFwiLCBwbGFjZURpcmVjdGlvbiwgeCwgeSk7XG4gICAgICAgICAgc3RlcFRocm91Z2hTZXR1cCgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIC8vIERvbid0IGRvIGFueXRoaW5nLCBqdXN0IHRyeSBhZ2FpbjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChwbGFjZUNydWlzZXIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBwbGFjZU93blNoaXAocGxheWVyMiwgXCJjcnVpc2VyXCIsIHBsYWNlRGlyZWN0aW9uLCB4LCB5KTtcbiAgICAgICAgICBzdGVwVGhyb3VnaFNldHVwKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gRG9uJ3QgZG8gYW55dGhpbmcsIGp1c3QgdHJ5IGFnYWluO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHBsYWNlU3VibWFyaW5lKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcGxhY2VPd25TaGlwKHBsYXllcjIsIFwic3VibWFyaW5lXCIsIHBsYWNlRGlyZWN0aW9uLCB4LCB5KTtcbiAgICAgICAgICBzdGVwVGhyb3VnaFNldHVwKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gRG9uJ3QgZG8gYW55dGhpbmcsIGp1c3QgdHJ5IGFnYWluO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHBsYWNlRGVzdHJveWVyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcGxhY2VPd25TaGlwKHBsYXllcjIsIFwiZGVzdHJveWVyXCIsIHBsYWNlRGlyZWN0aW9uLCB4LCB5KTtcbiAgICAgICAgICBwbGFjaW5nU2hpcHMgPSBmYWxzZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBEb24ndCBkbyBhbnl0aGluZywganVzdCB0cnkgYWdhaW47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gSW50ZXJzaXRpYWwgc2NyZWVuIHRvIG1ha2UgMi1wbGF5ZXIgcG9zc2libGUgb24gb25lIHNjcmVlblxuICBjb25zdCBzaG93SW50ZXJzdGl0aWFsID0gKHR1cm4pID0+IHtcbiAgICBjb25jZWFsQm9hcmQocGxheWVyT25lU3F1YXJlcyk7XG4gICAgY29uY2VhbEJvYXJkKHBsYXllclR3b1NxdWFyZXMpO1xuICAgIGxlZnRCb2FyZC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgcmlnaHRCb2FyZC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgaW50ZXJzdGl0aWFsTW9kYWwuc3R5bGUuZGlzcGxheSA9IFwiZ3JpZFwiO1xuICAgIGlmICh0dXJuID09PSBcInBsYXllcjFcIikge1xuICAgICAgaW50ZXJzdGl0aWFsVGV4dC50ZXh0Q29udGVudCA9IGBQbGF5ZXIgMSwgY2xpY2sgJ1JlYWR5JyB0byBwcm9jZWVkIHdpdGggeW91ciB0dXJuLmA7XG4gICAgfSBlbHNlIGlmICh0dXJuID09PSBcInBsYXllcjJcIikge1xuICAgICAgaW50ZXJzdGl0aWFsVGV4dC50ZXh0Q29udGVudCA9IGBQbGF5ZXIgMiwgY2xpY2sgJ1JlYWR5JyB0byBwcm9jZWVkIHdpdGggeW91ciB0dXJuLmA7XG4gICAgfVxuICB9O1xuXG4gIC8vIFRyYW5zaXRpb24gYmFjayBmcm9tIGludGVyc3RpdGlhbCB0byB0aGUgZ2l2ZW4gcGxheWVyJ3MgdHVyblxuICBjb25zdCBjbG9zZUludGVyc3RpdGlhbCA9ICh0dXJuKSA9PiB7XG4gICAgaWYgKHR1cm4gPT09IFwicGxheWVyMVwiKSB7XG4gICAgICBwbGF5ZXJPbmVTcXVhcmVzLmZvckVhY2goKHNxdWFyZSkgPT4gc3F1YXJlLmNsYXNzTGlzdC5yZW1vdmUoXCJmb2dvZndhclwiKSk7XG4gICAgICByaWdodEJvYXJkLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImF1dG9cIjtcbiAgICB9IGVsc2UgaWYgKHR1cm4gPT09IFwicGxheWVyMlwiKSB7XG4gICAgICBwbGF5ZXJUd29TcXVhcmVzLmZvckVhY2goKHNxdWFyZSkgPT4gc3F1YXJlLmNsYXNzTGlzdC5yZW1vdmUoXCJmb2dvZndhclwiKSk7XG4gICAgICBsZWZ0Qm9hcmQuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiYXV0b1wiO1xuICAgIH1cbiAgICBpbnRlcnN0aXRpYWxNb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIH07XG5cbiAgLy8gSGlkZSB0aGUgdW52aXNpdGVkIHNxdWFyZXMgb2YgYSBnaXZlbiBib2FyZFxuICBjb25zdCBjb25jZWFsQm9hcmQgPSAoYXJyKSA9PiB7XG4gICAgYXJyLmZvckVhY2goKHNxdWFyZSkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICAhc3F1YXJlLmNsYXNzTGlzdC5jb250YWlucyhcImhpdFwiKSAmJlxuICAgICAgICAhc3F1YXJlLmNsYXNzTGlzdC5jb250YWlucyhcIm1pc3NcIilcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcImZvZ29md2FyXCIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8qKiBTaG93IGEgZ2hvc3QgaW1hZ2Ugb2YgYSBzaGlwIHRvIHJldmlldyBiZWZvcmUgcGxhY2luZyBpdCAqL1xuICBjb25zdCBoaWdobGlnaHRSYW5nZSA9IChwbGF5ZXIsIHJhbmdlLCBkaXJlY3Rpb24sIHgsIHkpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlOyBpKyspIHtcbiAgICAgIGlmIChcbiAgICAgICAgZGlyZWN0aW9uID09PSBcImhvcml6b250YWxcIlxuICAgICAgICAgID8geCArIGkgPD0gcGxheWVyLmJvYXJkLmdyaWRTaXplXG4gICAgICAgICAgOiB5ICsgaSA8PSBwbGF5ZXIuYm9hcmQuZ3JpZFNpemVcbiAgICAgICkge1xuICAgICAgICBjb25zdCBzcXVhcmUgPVxuICAgICAgICAgIGRpcmVjdGlvbiA9PT0gXCJob3Jpem9udGFsXCJcbiAgICAgICAgICAgID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7cGxheWVyLm5hbWV9JHt4ICsgaX0ke3l9YClcbiAgICAgICAgICAgIDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7cGxheWVyLm5hbWV9JHt4fSR7eSArIGl9YCk7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic2hpcHByZXZpZXdcIik7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKiBDbGVhciBnaG9zdCBpbWFnZSB3aGVuIG5vdCBvdmVyIGFuIGVsZW1lbnQgb3IgY2hhbmdpbmcgZGlyZWN0aW9uICovXG4gIGNvbnN0IGNsZWFySGlnaGxpZ2h0ID0gKHBsYXllcikgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHBsYXllci5ib2FyZC5ncmlkU2l6ZTsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8PSBwbGF5ZXIuYm9hcmQuZ3JpZFNpemU7IGorKykge1xuICAgICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtwbGF5ZXIubmFtZX0ke2p9JHtpfWApO1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LnJlbW92ZShcInNoaXBwcmV2aWV3XCIpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKiogUGxhY2VzIGEgc2hpcCBvbiB0aGUgYm9hcmQgYW5kIHJlZmxlY3RzIHRoaXMgaW4gdGhlIERPTSAqL1xuICBjb25zdCBwbGFjZU93blNoaXAgPSAocGxheWVyLCBuYW1lLCBkaXJlY3Rpb24sIHgsIHkpID0+IHtcbiAgICBsZXQgbXlTaGlwID0gcGxheWVyLmJvYXJkLnBsYWNlU2hpcChuYW1lLCBkaXJlY3Rpb24sIHgsIHkpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbXlTaGlwLnNoaXAuc2l6ZTsgaSsrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPVxuICAgICAgICBkaXJlY3Rpb24gPT09IFwiaG9yaXpvbnRhbFwiXG4gICAgICAgICAgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtwbGF5ZXIubmFtZX0ke3ggKyBpfSR7eX1gKVxuICAgICAgICAgIDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7cGxheWVyLm5hbWV9JHt4fSR7eSArIGl9YCk7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcIm93bmZsZWV0XCIpO1xuICAgIH1cbiAgfTtcblxuICAvKiogRGVjbGFyZSB3aW5uZXIgYW5kIGRpc2FibGUgYXR0YWNraW5nIGJlaGF2aW9yICovXG4gIGNvbnN0IGVuZEdhbWUgPSAocGxheWVyKSA9PiB7XG4gICAgbGV0IHdpbm5lcjtcbiAgICBsZXQgbG9zZXI7XG5cbiAgICBpZiAocGxheWVyID09PSBwbGF5ZXIxKSB7XG4gICAgICB3aW5uZXIgPSBsZWZ0TmFtZS50ZXh0Q29udGVudDtcbiAgICAgIGxvc2VyID0gcmlnaHROYW1lLnRleHRDb250ZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5uZXIgPSByaWdodE5hbWUudGV4dENvbnRlbnQ7XG4gICAgICBsb3NlciA9IGxlZnROYW1lLnRleHRDb250ZW50O1xuICAgIH1cbiAgICBtYWluLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcbiAgICBlbmRNb2RhbC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhdXRvXCI7XG4gICAgZW5kTW9kYWwuc3R5bGUuZGlzcGxheSA9IFwiZ3JpZFwiO1xuICAgIGhlbHBUZXh0LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlbmRUZXh0LnRleHRDb250ZW50ID0gYCR7d2lubmVyfSBzdW5rIGFsbCBvZiAke2xvc2VyfSdzXG4gICAgIHNoaXBzLiAke3dpbm5lcn0gd2lucyFgO1xuICB9O1xuXG4gIC8vIERpc3BsYXkgZXJyb3JzIGluIGEgbW9kYWwgZm9yIHRoZSB1c2VyXG4gIGNvbnN0IGhhbmRsZUVycm9yID0gKGVycm9yKSA9PiB7XG4gICAgZXJyb3JNb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJncmlkXCI7XG4gICAgZXJyb3JUZXh0LnRleHRDb250ZW50ID0gZXJyb3I7XG4gIH07XG5cbiAgaW5pdGlhbGl6ZVBsYXllcnMoKTtcblxuICBmaWxsQm9hcmQocGxheWVyMSwgbGVmdEJvYXJkLCBwbGF5ZXIyKTtcbiAgZmlsbEJvYXJkKHBsYXllcjIsIHJpZ2h0Qm9hcmQsIHBsYXllcjEpO1xufTtcblxuaG9tZUxvYWQoKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///877\n')}},__webpack_require__={};__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(I){if("object"==typeof window)return window}}(),(()=>{var I;__webpack_require__.g.importScripts&&(I=__webpack_require__.g.location+"");var g=__webpack_require__.g.document;if(!I&&g&&(g.currentScript&&"SCRIPT"===g.currentScript.tagName.toUpperCase()&&(I=g.currentScript.src),!I)){var e=g.getElementsByTagName("script");if(e.length)for(var n=e.length-1;n>-1&&(!I||!/^http(s?):/.test(I));)I=e[n--].src}if(!I)throw new Error("Automatic publicPath is not supported in this browser");I=I.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=I})();var __webpack_exports__={};__webpack_modules__[877](0,__webpack_exports__,__webpack_require__)})();